<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <meta name="renderer" content="webkit">

  
  <title>POI和easyExcel | bp的Blog</title>

  <link rel="shortcut icon" href="/images/favicon.png">
  
  <meta name="description" content="POI和easyExcel首先来说文件的读写跟excel的读写本质上没有区别，都是跟io相关，所以说用最原生的io也能做到excel的读写，但这样很麻烦，因此我们引用第三方的组件工具来加速我们的开发 应用场景开发中常用到excel的处理，如导出excel，导入excel到数据库中 操作excel目前比较流行的时Apache POI 和阿里巴巴的easyExcel Excel格式分析格式分析 xls">
<meta name="keywords" content="excel">
<meta property="og:type" content="article">
<meta property="og:title" content="POI和easyExcel">
<meta property="og:url" content="https://yellowbp.github.io/2021/05/29/POI和easyExcel/index.html">
<meta property="og:site_name" content="bp的Blog">
<meta property="og:description" content="POI和easyExcel首先来说文件的读写跟excel的读写本质上没有区别，都是跟io相关，所以说用最原生的io也能做到excel的读写，但这样很麻烦，因此我们引用第三方的组件工具来加速我们的开发 应用场景开发中常用到excel的处理，如导出excel，导入excel到数据库中 操作excel目前比较流行的时Apache POI 和阿里巴巴的easyExcel Excel格式分析格式分析 xls">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://easyexcelimages.oss-cn-beijing.aliyuncs.com/excel%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B.png">
<meta property="og:image" content="https://easyexcelimages.oss-cn-beijing.aliyuncs.com/excel%E6%A8%A1%E6%9D%BF%E5%9B%BE.png">
<meta property="og:updated_time" content="2021-07-23T07:33:25.598Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="POI和easyExcel">
<meta name="twitter:description" content="POI和easyExcel首先来说文件的读写跟excel的读写本质上没有区别，都是跟io相关，所以说用最原生的io也能做到excel的读写，但这样很麻烦，因此我们引用第三方的组件工具来加速我们的开发 应用场景开发中常用到excel的处理，如导出excel，导入excel到数据库中 操作excel目前比较流行的时Apache POI 和阿里巴巴的easyExcel Excel格式分析格式分析 xls">
<meta name="twitter:image" content="https://easyexcelimages.oss-cn-beijing.aliyuncs.com/excel%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B.png">

  <meta name="format-detection" content="telephone=no,email=no">
  <meta name="theme-color" content="#9C27B0">
  <meta name="description" content>
  <meta name="keywords" content=",excel">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="bp的Blog">
  <meta name="msapplication-starturl" content="https://yellowbp.github.io/2021/05/29/POI和easyExcel/">
  <meta name="msapplication-navbutton-color" content="#9C27B0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="bp的Blog">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/images/favicon.png">

  
    <meta property="article:published_time" content="Sat May 29 2021 10:07:04 GMT+0800">
    <meta property="article:modified_time" content="Fri Jul 23 2021 15:33:25 GMT+0800">
  

  
    <link rel="canonical" href="https://yellowbp.github.io/2021/05/29/POI和easyExcel/">
  

  <meta name="google-site-verification" content="fXjtlIfaDc_X-0P11rO3bEp1Nk4IKXphoJv0GqGZCco">
  <meta name="baidu-site-verification" content="I3t1wfwZvd">

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create','UA-139531378-1','auto');ga('send','pageview');
</script>
  <script>
  var _hmt = _hmt || [];
  (function() {var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?1054d51c0b66f1d168829173682c8159';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script>
  

  <link rel="stylesheet" href="/css/mdui.css">
<link rel="stylesheet" href="/css/style.css">
</head>
<body class="mdui-appbar-with-toolbar mdui-drawer-body-left mdui-theme-primary-brown mdui-theme-accent-blue">
  <script>var a=localStorage.getItem("mdui-theme-layout-dark");if(a){document.getElementsByTagName("body")[0].className+=" mdui-theme-layout-dark"};</script>
  <header id="header" class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide mdui-appbar-inset">
  <div class="mdui-toolbar mdui-color-theme">
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="mdui-icon material-icons">menu</i></a>
    <a href="/" class="mdui-typo-headline">bp的Blog</a>
    <div class="mdui-toolbar-spacer"></div>
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: '搜索'}"><i class="mdui-icon material-icons">search</i></a>
    
  </div>
</header>
<div class="mdui-dialog" id="search">
  
    <div class="search-form">
      <input type="search" class="search-form-input" placeholder="请输入关键字">
    </div>
    <div class="search-result" data-resource="/search.xml"></div>
  
</div>
  <aside id="sidebar" class="mdui-drawer mdui-drawer-full-height">
  <div class="mdui-grid-tile">
    <img src="/images/Gradient1.jpg" style="height: 160px;">
    <img src="/images/headPic.jpg" class="avatar-animation" style="position: absolute; top: 10%; left: 24px; width: 64px; height: 64px; border: 2px solid #fff; border-radius: 50%;">
    <div class="mdui-grid-tile-actions">
      <div class="mdui-grid-tile-text">
        <div class="mdui-grid-tile-title">hbp
        </div>
        <div class="mdui-grid-tile-subtitle"><i class="mdui-icon material-icons">art_track</i>要想快，先会慢</div>
      </div>
      
        <div class="mdui-grid-tile-buttons">
          <a href="mailto:347070556@qq.com" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: '347070556@qq.com'}"><i class="mdui-icon material-icons">email</i></a>
        </div>
      
    </div>
  </div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    <a href="/" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">home</i>
      <div class="mdui-list-item-content">主页</div>
    </a>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-deep-orange">inbox</i>
        <div class="mdui-list-item-content">归档</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/archives/2021/07/">七月 2021<span class="mdui-ripple sidebar_archives-count">13</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/06/">六月 2021<span class="mdui-ripple sidebar_archives-count">4</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/05/">五月 2021<span class="mdui-ripple sidebar_archives-count">5</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/04/">四月 2021<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/03/">三月 2021<span class="mdui-ripple sidebar_archives-count">5</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/02/">二月 2021<span class="mdui-ripple sidebar_archives-count">5</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/01/">一月 2021<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2020/03/">三月 2020<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/12/">十二月 2019<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/11/">十一月 2019<span class="mdui-ripple sidebar_archives-count">5</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/10/">十月 2019<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/08/">八月 2019<span class="mdui-ripple sidebar_archives-count">6</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-green">chrome_reader_mode</i>
        <div class="mdui-list-item-content">分类</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/categories/Spring/">Spring<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/Spring-Cloud-Alibaba/">Spring Cloud Alibaba<span class="mdui-ripple sidebar_archives-count">7</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/docker/">docker<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/git/">git<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/java基础/">java基础<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/linux/">linux<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/mybatis/">mybatis<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/redis/">redis<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/servlet/">servlet<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/基础/">基础<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/安全框架/">安全框架<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/工具类/">工具类<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/技术/">技术<span class="mdui-ripple sidebar_archives-count">24</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/搭建/">搭建<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/数据库/">数据库<span class="mdui-ripple sidebar_archives-count">4</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/服务器/">服务器<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/测试/">测试<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/电脑硬件/">电脑硬件<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/规范/">规范<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/部署/">部署<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/重装/">重装<span class="mdui-ripple sidebar_archives-count">1</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-brown">bookmark</i>
        <div class="mdui-list-item-content">标签</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/tags/Spring/">Spring<span class="mdui-ripple sidebar_archives-count">7</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/algorithm/">algorithm<span class="mdui-ripple sidebar_archives-count">7</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/excel/">excel<span class="mdui-ripple sidebar_archives-count">4</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/git/">git<span class="mdui-ripple sidebar_archives-count">8</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/hexo/">hexo<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/javaWeb/">javaWeb<span class="mdui-ripple sidebar_archives-count">7</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/java基础/">java基础<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/linux/">linux<span class="mdui-ripple sidebar_archives-count">4</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/mysql/">mysql<span class="mdui-ripple sidebar_archives-count">4</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/nginx/">nginx<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/redis/">redis<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/servlet/">servlet<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/spring/">spring<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/win7/">win7<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/其他/">其他<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/分布式/">分布式<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/接口文档/">接口文档<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/笔记本选购/">笔记本选购<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/自动化构建工具/">自动化构建工具<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/设计模式/">设计模式<span class="mdui-ripple sidebar_archives-count">1</span></a>
        
      </div>
    </div>
    <a href="/about" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-purple">person</i>
      <div class="mdui-list-item-content">关于</div>
    </a>
  </div>

  <div class="mdui-divider"></div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <div class="mdui-list-item-content">友情链接</div>
        <i class="mdui-list-item-icon mdui-icon material-icons">link</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        
          <a href="javascript:;" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme" style="justify-content: center;">链接为空</a>
        
      </div>
    </div>
  </div>
</aside>
  <main id="main" class="mdui-m-t-5 fadeIn animated">
  <link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css">
  <style>#main article .mdui-card-content .center-block{display:block!important;margin-right:auto!important;margin-left:auto!important}</style>
  <article class="mdui-card mdui-m-b-5">
    <header class="mdui-card-media">
      <img src="/images/random/material-7.png" style="max-height: 240px;">
      <div class="mdui-card-media-covered">
        <div class="mdui-card-primary">
          <div class="mdui-card-primary-title">POI和easyExcel</div>
          <div class="mdui-card-primary-subtitle"><i class="iconfont">&#xe697;</i> 2021-05-29 / 
          <i class="iconfont">&#xe601;</i> hbp
          <span id="busuanzi_container_page_pv">
            本文总阅读量<span id="busuanzi_value_page_pv"></span>次
          </span>
          </div>
        </div>
      </div>
      <div class="mdui-card-menu">
        
        
      </div>
    </header>
    <div class="mdui-card-content mdui-typo">
      <h1 id="POI和easyExcel"><a href="#POI和easyExcel" class="headerlink" title="POI和easyExcel"></a>POI和easyExcel</h1><p>首先来说文件的读写跟excel的读写本质上没有区别，都是跟io相关，所以说用最原生的io也能做到excel的读写，但这样很麻烦，因此我们引用第三方的组件工具来加速我们的开发</p>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p>开发中常用到excel的处理，如导出excel，导入excel到数据库中</p>
<p>操作excel目前比较流行的时<strong>Apache POI</strong> 和阿里巴巴的<strong>easyExcel</strong></p>
<h2 id="Excel格式分析格式分析"><a href="#Excel格式分析格式分析" class="headerlink" title="Excel格式分析格式分析"></a>Excel格式分析格式分析</h2><ul>
<li>xls是Microsoft Excel2007前excel的文件存储格式，实现原理是基于微软的ole db是微软com组件的一种实现，本质上也是一个微型数据库，由于微软的东西很多不开源，另外也已经被淘汰，了解它的细节意义不大，底层的编程都是基于微软的com组件去开发的。</li>
<li>xlsx是Microsoft Excel2007后excel的文件存储格式，实现是基于openXml和zip技术。这种存储简单，安全传输方便，同时处理数据也变的简单。</li>
<li>csv 我们可以理解为纯文本文件，可以被excel打开。他的格式非常简单，解析起来和解析文本文件一样。</li>
</ul>
<h2 id="组件对比"><a href="#组件对比" class="headerlink" title="组件对比"></a>组件对比</h2><h3 id="POI"><a href="#POI" class="headerlink" title="POI"></a>POI</h3><h4 id="Excel读写时候内存溢出"><a href="#Excel读写时候内存溢出" class="headerlink" title="Excel读写时候内存溢出"></a>Excel读写时候内存溢出</h4><p>大部分使用POI都是使用他的userModel模式。userModel的好处是上手容易使用简单，随便拷贝个代码跑一下，剩下就是写业务转换了，虽然转换也要写上百行代码，相对比较好理解。然而userModel模式最大的问题是在于非常大的内存消耗，一个几兆的文件解析要用掉上百兆的内存。现在很多应用采用这种模式，之所以还正常在跑一定是并发不大，并发上来后一定会OOM或者频繁的full gc。</p>
<h4 id="使用复杂和学习成本"><a href="#使用复杂和学习成本" class="headerlink" title="使用复杂和学习成本"></a>使用复杂和学习成本</h4><p>对POI有过深入了解的估计才知道原来POI还有SAX模式。但SAX模式相对比较复杂，excel有03和07两种版本，两个版本数据存储方式截然不同，sax解析方式也各不一样。想要了解清楚这两种解析方式，才去写代码测试，估计两天时间是需要的。再加上即使解析完，要转换到自己业务模型还要很多繁琐的代码。总体下来感觉至少需要三天，由于代码复杂，后续维护成本巨大。</p>
<p>而且由于我们的系统大多数都是大并发的情况下运行的，在大并发情况下，我们会发现poi存在一些bug。</p>
<p>poi有一套SAX模式的API可以一定程度的解决一些内存溢出的问题，但PO还是有一些缺陷，比如07版Excel解压缩以及解压后存储都是在内存中完成的，内存消耗依然很大。</p>
<p><strong>总结上述来说：简单写法重度依赖内存，复杂写法学习成本高</strong></p>
<h4 id="基本类功能"><a href="#基本类功能" class="headerlink" title="基本类功能"></a>基本类功能</h4><ul>
<li>HSSF – 提供读写Microsoft Excel格式档案的功能</li>
<li>XSSF – 提供读写Microsoft Excel OOXML格式档案的功能（专门用来处理07版的excel，当然会还有一个SXSSF升级版(XSSF的优化)）</li>
<li>HWPF – 提供读写Microsoft Word格式档案的功能</li>
<li>HSLF – 提供读写Microsoft PowerPoint格式档案的功能</li>
<li>HDGF － 提供读写Microsoft Visio格式档案的功能</li>
</ul>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ol>
<li>功能强大</li>
<li>代码书写繁冗</li>
<li>内存问题：读写大文件耗费内存较大，POI是先将数据都先加载到内存中，在写入文件，当数据量大时，容易OOM</li>
</ol>
<h3 id="easyExcel"><a href="#easyExcel" class="headerlink" title="easyExcel"></a>easyExcel</h3><h4 id="重写了POI对07版Excel的解析"><a href="#重写了POI对07版Excel的解析" class="headerlink" title="重写了POI对07版Excel的解析"></a>重写了POI对07版Excel的解析</h4><p>能够原本一个3M的excel用POI sax依然需要100M左右内存降低到几M，并且再大的excel不会出现内存溢出，03版仍依赖POl的sax模式。在上层做了模型转换的封装，让使用者更加简单方便</p>
<p><img src="https://easyexcelimages.oss-cn-beijing.aliyuncs.com/excel%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B.png" alt></p>
<h4 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h4><ol>
<li>在数据模型层面进行了封装，<strong>使用简单</strong></li>
<li>重写了07版的Excel的解析代码，降低内存消耗，避免将全部全部数据一次加载到内存，采用sax模式一行一行解析，能有效避免OOM，两者有点像时间换空间，空间换时间的意思</li>
<li>只能操作excel</li>
<li>不能读取图片</li>
</ol>
<h2 id="POI-1"><a href="#POI-1" class="headerlink" title="POI"></a>POI</h2><h3 id="excel写"><a href="#excel写" class="headerlink" title="excel写"></a>excel写</h3><ol>
<li><p>打开idea，创建一个maven项目，然后删除src文件夹，再新建moudle</p>
</li>
<li><p>导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--xls(03)--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--xls(07)--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--日期格式化工具 比官方的util.date好用--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.10.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--test--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p><strong>03 | 07 版本的写，就只是对象不同，方法一样的</strong></p>
<p>需要注意：03版本和07版本存在兼容性问题，03版本最多只有65535行</p>
<p><strong>【分析】</strong></p>
<p>java万物皆对象，那么excel也是不例外的</p>
<h3 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h3><p>然后我们只需要创建这些必要的对象，然后进行对应的操作即可</p>
<ol>
<li>工作簿(一个excel文件就是一个工作簿)</li>
<li>工作表</li>
<li>行列</li>
</ol>
<h4 id="03版本："><a href="#03版本：" class="headerlink" title="03版本："></a><strong>03版本：</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelWriteTest03</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String PATH = <span class="string">"H:\\code\\poiAndExcel\\"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrite03</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 1.创建工作簿</span></span><br><span class="line">        Workbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">        <span class="comment">// 2.创建一个工作表(有簿才有表)</span></span><br><span class="line">        Sheet sheet = workbook.createSheet(<span class="string">"sheet的名字在此更改，可缺省"</span>);</span><br><span class="line">        <span class="comment">// 3.创建一行(有表才有行) 0代表excel的第一行</span></span><br><span class="line">        Row row1 = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 4.创建一个单元格(行列重叠处)，对应excel坐标为(1,1) 以下代码可以理解为一列</span></span><br><span class="line">        Cell cell11 = row1.createCell(<span class="number">0</span>);</span><br><span class="line">        cell11.setCellValue(<span class="string">"这周加班次数"</span>);</span><br><span class="line">        <span class="comment">// (1,2)</span></span><br><span class="line">        Cell cell12 = row1.createCell(<span class="number">1</span>);</span><br><span class="line">        cell12.setCellValue(<span class="number">666</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//第二行 (2,1)</span></span><br><span class="line">        Row row2 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        Cell cell21 = row2.createCell(<span class="number">0</span>);</span><br><span class="line">        cell21.setCellValue(<span class="string">"统计时间"</span>);</span><br><span class="line">        <span class="comment">// (2,2)</span></span><br><span class="line">        Cell cell22 = row2.createCell(<span class="number">1</span>);</span><br><span class="line">        String time = <span class="keyword">new</span> DateTime().toString(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        cell22.setCellValue(time);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//生成一张表(本质IO操作，IO操作就需要流处理) 03版本对应的扩展名xls</span></span><br><span class="line">        FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(PATH + <span class="string">"excel的命名03.xls"</span>);</span><br><span class="line">        <span class="comment">//输出</span></span><br><span class="line">        workbook.write(fileOutputStream);</span><br><span class="line">        <span class="comment">//关闭流</span></span><br><span class="line">        fileOutputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="07版本："><a href="#07版本：" class="headerlink" title="07版本："></a><strong>07版本：</strong></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelWriteTest07</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String PATH = <span class="string">"H:\\code\\poiAndExcel\\"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrite07</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 1.创建工作簿 TODO 07版本只需要修改为XSSF</span></span><br><span class="line">        Workbook workbook = <span class="keyword">new</span> XSSFWorkbook();</span><br><span class="line">        <span class="comment">// 2.创建一个工作表(有簿才有表)</span></span><br><span class="line">        Sheet sheet = workbook.createSheet(<span class="string">"sheet的名字在此更改，可缺省"</span>);</span><br><span class="line">        <span class="comment">// 3.创建一行(有表才有行) 0代表excel的第一行</span></span><br><span class="line">        Row row1 = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 4.创建一个单元格(行列重叠处)，对应excel坐标为(1,1) 以下代码可以理解为一列</span></span><br><span class="line">        Cell cell11 = row1.createCell(<span class="number">0</span>);</span><br><span class="line">        cell11.setCellValue(<span class="string">"这周加班次数"</span>);</span><br><span class="line">        <span class="comment">// (1,2)</span></span><br><span class="line">        Cell cell12 = row1.createCell(<span class="number">1</span>);</span><br><span class="line">        cell12.setCellValue(<span class="number">666</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//第二行 (2,1)</span></span><br><span class="line">        Row row2 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        Cell cell21 = row2.createCell(<span class="number">0</span>);</span><br><span class="line">        cell21.setCellValue(<span class="string">"统计时间"</span>);</span><br><span class="line">        <span class="comment">// (2,2)</span></span><br><span class="line">        Cell cell22 = row2.createCell(<span class="number">1</span>);</span><br><span class="line">        String time = <span class="keyword">new</span> DateTime().toString(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        cell22.setCellValue(time);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//生成一张表(本质IO操作，IO操作就需要流处理) 03版本对应的扩展名xlsx</span></span><br><span class="line">        FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(PATH + <span class="string">"excel的命名07.xlsx"</span>);</span><br><span class="line">        <span class="comment">//输出</span></span><br><span class="line">        workbook.write(fileOutputStream);</span><br><span class="line">        <span class="comment">//关闭流</span></span><br><span class="line">        fileOutputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>【注意】这两个版本就是对象的区别和文件名后缀的区别</p>
<p>数据的批量写入</p>
<blockquote>
<p>大文件写HSSF</p>
</blockquote>
<p>缺点：最多只能处理到第65536行，否则会抛出异常</p>
<p><code>java.lang.IllegalArgumentException: Invalid row number (65536) outside allowable range (0..65535)</code></p>
<p>优点：过程写入缓存，不操作磁盘，最后一次性写入磁盘，速度快</p>
<p>以下的代码其实跟上述的03版本是一样的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrite03BigData</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 开始时间</span></span><br><span class="line">    <span class="keyword">long</span> begin = System.currentTimeMillis();</span><br><span class="line">    <span class="comment">// 创建工作簿</span></span><br><span class="line">    Workbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">    <span class="comment">// 创建一个工作表(有簿才有表)</span></span><br><span class="line">    Sheet sheet = workbook.createSheet(<span class="string">"sheet的名字在此更改，可缺省"</span>);</span><br><span class="line">    <span class="comment">//写入数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> rowNum = <span class="number">0</span>; rowNum &lt; <span class="number">65536</span>; rowNum++) &#123;</span><br><span class="line">        Row row = sheet.createRow(rowNum);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> colNum = <span class="number">0</span>; colNum &lt; <span class="number">10</span>; colNum++) &#123;</span><br><span class="line">            Cell cell = row.createCell(colNum);</span><br><span class="line">            cell.setCellValue(colNum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//生成一张表(本质IO操作，IO操作就需要流处理) 03版本对应的扩展名xls</span></span><br><span class="line">    FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(PATH + <span class="string">"excel的命名03BigData.xls"</span>);</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    workbook.write(fileOutputStream);</span><br><span class="line">    <span class="comment">//关闭流</span></span><br><span class="line">    fileOutputStream.close();</span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">    System.out.println((<span class="keyword">double</span>)(end - begin) / <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//得出的时间为0.662</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>大文件写XSSF</p>
</blockquote>
<p>缺点：写数据时速度慢，非常耗内存，也会发生内存溢出，如100w条</p>
<p>优点：可以写较大的数据量（不局限于65536，因为是操作07版的excel）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrite07BigData</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 开始时间</span></span><br><span class="line">    <span class="keyword">long</span> begin = System.currentTimeMillis();</span><br><span class="line">    <span class="comment">// 创建工作簿</span></span><br><span class="line">    Workbook workbook = <span class="keyword">new</span> XSSFWorkbook();</span><br><span class="line">    <span class="comment">// 创建一个工作表(有簿才有表)</span></span><br><span class="line">    Sheet sheet = workbook.createSheet(<span class="string">"sheet的名字在此更改，可缺省"</span>);</span><br><span class="line">    <span class="comment">//写入数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> rowNum = <span class="number">0</span>; rowNum &lt; <span class="number">65537</span>; rowNum++) &#123;</span><br><span class="line">        Row row = sheet.createRow(rowNum);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> colNum = <span class="number">0</span>; colNum &lt; <span class="number">10</span>; colNum++) &#123;</span><br><span class="line">            Cell cell = row.createCell(colNum);</span><br><span class="line">            cell.setCellValue(colNum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//生成一张表(本质IO操作，IO操作就需要流处理) 03版本对应的扩展名xls</span></span><br><span class="line">    FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(PATH + <span class="string">"excel的命名07BigData.xlsx"</span>);</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    workbook.write(fileOutputStream);</span><br><span class="line">    <span class="comment">//关闭流</span></span><br><span class="line">    fileOutputStream.close();</span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">    System.out.println((<span class="keyword">double</span>)(end - begin) / <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//得出的时间为4.978</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>大文件写SXSSF</p>
</blockquote>
<p>优点：它其实就是XSSF的一个优化，可以写大数据量，而且写数据速度快，占用更少的内存</p>
<p>【注意】</p>
<p>过程中会产生临时文件，需要清理临时文件</p>
<p>默认由100条记录被保存在内存中，如果超过这数量，则最前面的数据被写入临时文件</p>
<p>如果想自定义内存中数据的数量，可以使用new SXSSFWorkbook(数量)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrite07BigDataS</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 开始时间</span></span><br><span class="line">    <span class="keyword">long</span> begin = System.currentTimeMillis();</span><br><span class="line">    <span class="comment">// 创建工作簿</span></span><br><span class="line">    Workbook workbook = <span class="keyword">new</span> SXSSFWorkbook();</span><br><span class="line">    <span class="comment">// 创建一个工作表(有簿才有表)</span></span><br><span class="line">    Sheet sheet = workbook.createSheet(<span class="string">"sheet的名字在此更改，可缺省"</span>);</span><br><span class="line">    <span class="comment">//写入数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> rowNum = <span class="number">0</span>; rowNum &lt; <span class="number">65537</span>; rowNum++) &#123;</span><br><span class="line">        Row row = sheet.createRow(rowNum);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> colNum = <span class="number">0</span>; colNum &lt; <span class="number">10</span>; colNum++) &#123;</span><br><span class="line">            Cell cell = row.createCell(colNum);</span><br><span class="line">            cell.setCellValue(colNum);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//生成一张表(本质IO操作，IO操作就需要流处理) 03版本对应的扩展名xls</span></span><br><span class="line">    FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(PATH + <span class="string">"excel的命名07BigDataS.xlsx"</span>);</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    workbook.write(fileOutputStream);</span><br><span class="line">    <span class="comment">//关闭流</span></span><br><span class="line">    fileOutputStream.close();</span><br><span class="line">    <span class="comment">// 清空临时文件</span></span><br><span class="line">    ((SXSSFWorkbook)workbook).dispose();</span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">    System.out.println((<span class="keyword">double</span>)(end - begin) / <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//得出的时间为0.962</span></span><br></pre></td></tr></table></figure>

<p>SXSSFWorkbook-来至官方的解释：实现”BigGridDemo”策略的流式XSSFWorkbook版本。这允许写入非常大的文件而不会耗尽内存，因为任何时候只有可配置的行部分被保存在内存中。<br>请注意，仍然可能会消耗大量内存，这些内存基于您正在使用的功能，例如合并区域，注释.…….仍然只存储在内存中，因此如果广泛使用，可能需要大量内存。</p>
<h3 id="Excel读"><a href="#Excel读" class="headerlink" title="Excel读"></a>Excel读</h3><h4 id="03版本"><a href="#03版本" class="headerlink" title="03版本"></a>03版本</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelReadTest03</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String PATH = <span class="string">"H:\\code\\poiAndExcel\\"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRead03</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 获取文件流</span></span><br><span class="line">        FileInputStream fileInputStream = <span class="keyword">new</span> FileInputStream(PATH + <span class="string">"excel的命名03.xls"</span>);</span><br><span class="line">        <span class="comment">// 读取到工作簿</span></span><br><span class="line">        Workbook workbook = <span class="keyword">new</span> HSSFWorkbook(fileInputStream);</span><br><span class="line">        <span class="comment">// 得到第一个表</span></span><br><span class="line">        Sheet sheet = workbook.getSheetAt(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 以下两行代码表示得到第一个单元格</span></span><br><span class="line">        Row row = sheet.getRow(<span class="number">0</span>);</span><br><span class="line">        Cell cell = row.getCell(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// getStringCellValue：获取字符串</span></span><br><span class="line">        <span class="comment">// getNumericCellValue：获取数值</span></span><br><span class="line">        <span class="comment">// 读取值的时候一定要注意类型，不然会报错，这里是个麻烦地方</span></span><br><span class="line">        System.out.println(cell.getStringCellValue());</span><br><span class="line">        fileInputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>【注意】获取值的类型</p>
<h4 id="07版本"><a href="#07版本" class="headerlink" title="07版本"></a>07版本</h4><p>与03版本的读取没太多区别，注意对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelReadTest07</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String PATH = <span class="string">"H:\\code\\poiAndExcel\\"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testRead07</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取文件流</span></span><br><span class="line">        FileInputStream fileInputStream = <span class="keyword">new</span> FileInputStream(PATH + <span class="string">"excel的命名07.xlsx"</span>);</span><br><span class="line">        <span class="comment">// 读取到工作簿</span></span><br><span class="line">        Workbook workbook = <span class="keyword">new</span> XSSFWorkbook(fileInputStream);</span><br><span class="line">        <span class="comment">// 得到第一个表</span></span><br><span class="line">        Sheet sheet = workbook.getSheetAt(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 以下两行代码表示得到第一个单元格</span></span><br><span class="line">        Row row = sheet.getRow(<span class="number">0</span>);</span><br><span class="line">        Cell cell = row.getCell(<span class="number">0</span>);</span><br><span class="line">		<span class="comment">// getStringCellValue：获取字符串</span></span><br><span class="line">        <span class="comment">// getNumericCellValue：获取数值</span></span><br><span class="line">        <span class="comment">// 读取值的时候一定要注意类型，不然会报错，这里是个麻烦地方</span></span><br><span class="line">        System.out.println(cell.getStringCellValue());</span><br><span class="line">        fileInputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="读取不同的数据类型（大头），下次使用可以直接cv"><a href="#读取不同的数据类型（大头），下次使用可以直接cv" class="headerlink" title="读取不同的数据类型（大头），下次使用可以直接cv"></a>读取不同的数据类型（大头），下次使用可以直接cv</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCellType</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    String path = <span class="string">"H:\\code\\poiAndExcel\\test03.xls"</span>;</span><br><span class="line">    <span class="comment">// 获取文件流</span></span><br><span class="line">    FileInputStream in = <span class="keyword">new</span> FileInputStream(path);</span><br><span class="line">    <span class="comment">// 读取到工作簿</span></span><br><span class="line">    Workbook workbook = <span class="keyword">new</span> HSSFWorkbook(in);</span><br><span class="line">    <span class="comment">// 得到第一个表格</span></span><br><span class="line">    Sheet sheet = workbook.getSheetAt(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 获取标题内容</span></span><br><span class="line">    Row rowTitle = sheet.getRow(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (rowTitle != <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="comment">// 一行有多少列有数据</span></span><br><span class="line">        <span class="keyword">int</span> cellCount = rowTitle.getPhysicalNumberOfCells();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> cellNum = <span class="number">0</span>;cellNum &lt; cellCount; cellNum++)&#123;</span><br><span class="line">            Cell cell = rowTitle.getCell(cellNum);</span><br><span class="line">            <span class="keyword">if</span> (cell != <span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="comment">// 获取值的类型(老版本是返回int值) 但注意：现在的版本中 CellType封装了这些值</span></span><br><span class="line">                CellType cellType = cell.getCellType();</span><br><span class="line">                String stringCellValue = cell.getStringCellValue();</span><br><span class="line">                System.out.print(stringCellValue + <span class="string">" | "</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//上面的内容只是展示如何获取一行中有值的个数</span></span><br><span class="line">    <span class="comment">// 获取表中的内容</span></span><br><span class="line">    <span class="keyword">int</span> physicalNumberOfRows = sheet.getPhysicalNumberOfRows();</span><br><span class="line">    <span class="comment">// 从第2行开始读</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> rowNum = <span class="number">1</span>;rowNum&lt;physicalNumberOfRows;rowNum++)&#123;</span><br><span class="line">        Row rowData = sheet.getRow(rowNum);</span><br><span class="line">        <span class="keyword">if</span> (rowData != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">// 读取列</span></span><br><span class="line">            <span class="keyword">int</span> cellCount = rowTitle.getPhysicalNumberOfCells();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> cellNum=<span class="number">0</span>; cellNum &lt; cellCount; cellNum++)&#123;</span><br><span class="line">                System.out.print(<span class="string">"["</span> +(rowNum+<span class="number">1</span>) + <span class="string">"-"</span> + (cellNum+<span class="number">1</span>) + <span class="string">"]"</span>);</span><br><span class="line">                Cell cell = rowData.getCell(cellNum);</span><br><span class="line">                <span class="comment">//匹配列的数据类型</span></span><br><span class="line">                <span class="keyword">if</span> (cell != <span class="keyword">null</span>)&#123;</span><br><span class="line">                    CellType cellType = cell.getCellType();</span><br><span class="line">                    Object cellValue = <span class="string">""</span>;</span><br><span class="line">                    <span class="keyword">switch</span> (cellType)&#123;</span><br><span class="line">                        <span class="keyword">case</span> STRING:</span><br><span class="line">                            System.out.print(<span class="string">"【String】"</span>);</span><br><span class="line">                            cellValue = cell.getStringCellValue();</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> BOOLEAN:</span><br><span class="line">                            System.out.print(<span class="string">"【Boolean】"</span>);</span><br><span class="line">                            cellValue = cell.getBooleanCellValue();</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> BLANK:</span><br><span class="line">                            System.out.print(<span class="string">"【Blank】"</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> NUMERIC:</span><br><span class="line">                            <span class="comment">//数字（日期、普通数字）</span></span><br><span class="line">                            System.out.print(<span class="string">"【Numeric】"</span>);</span><br><span class="line">                            <span class="keyword">if</span> (HSSFDateUtil.isCellDateFormatted(cell))&#123;</span><br><span class="line">                                <span class="comment">// 日期</span></span><br><span class="line">                                System.out.print(<span class="string">"【日期】"</span>);</span><br><span class="line">                                Date dateCellValue = cell.getDateCellValue();</span><br><span class="line">                                cellValue = <span class="keyword">new</span> DateTime(dateCellValue).toString(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">                            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="comment">// 不是日期格式，防止数字过长</span></span><br><span class="line">                                System.out.print(<span class="string">"【转换为字符串输出】"</span>);</span><br><span class="line">                                cell.setCellType(CellType.STRING);</span><br><span class="line">                                cellValue = cell.toString();</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> ERROR:</span><br><span class="line">                            System.out.print(<span class="string">"【Error，数据类型错误】"</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(cellValue);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    in.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果要提取为一个工具类，只需要把<code>FileInputStream in</code>作为参数传进来即可</p>
<h4 id="计算公式"><a href="#计算公式" class="headerlink" title="计算公式"></a>计算公式</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFormula</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    FileInputStream in = <span class="keyword">new</span> FileInputStream(<span class="string">"H:\\code\\poiAndExcel\\公式.xls"</span>);</span><br><span class="line">    Workbook workbook = <span class="keyword">new</span> HSSFWorkbook(in);</span><br><span class="line">    Sheet sheet = workbook.getSheetAt(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 结合以下代码，如果此单元格不是公式的话，是打印不出结果的，也不会报错</span></span><br><span class="line">    Row row = sheet.getRow(<span class="number">4</span>);</span><br><span class="line">    Cell cell = row.getCell(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 拿到计算公式 (面向接口编程)</span></span><br><span class="line">    FormulaEvaluator FormulaEvaluator = <span class="keyword">new</span> HSSFFormulaEvaluator((HSSFWorkbook)workbook);</span><br><span class="line">    <span class="comment">// 输出单元格的内容</span></span><br><span class="line">    CellType cellType = cell.getCellType();</span><br><span class="line">    <span class="keyword">switch</span> (cellType)&#123;</span><br><span class="line">        <span class="keyword">case</span> FORMULA:</span><br><span class="line">            <span class="comment">// 得到公式</span></span><br><span class="line">            String cellFormula = cell.getCellFormula();</span><br><span class="line">            System.out.println(cellFormula);<span class="comment">// 输出 SUM(A2:A4)</span></span><br><span class="line">            <span class="comment">// 计算</span></span><br><span class="line">            CellValue evaluate = FormulaEvaluator.evaluate(cell);</span><br><span class="line">            <span class="comment">// 格式化为字符串</span></span><br><span class="line">            String cellValue = evaluate.formatAsString();</span><br><span class="line">            System.out.println(cellValue);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    in.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="easyExcel-1"><a href="#easyExcel-1" class="headerlink" title="easyExcel"></a>easyExcel</h2><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><h4 id="导入依赖"><a href="#导入依赖" class="headerlink" title="导入依赖"></a>导入依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="简单读"><a href="#简单读" class="headerlink" title="简单读"></a>简单读</h4><h5 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">单实体导入</span><br><span class="line">导入Excel学员信息到系统。</span><br><span class="line">包含如下列：姓名、性别、出生日期</span><br><span class="line">模板详见：学生信息.xls</span><br><span class="line"></span><br><span class="line">学生姓名	学生性别	学生出生日期</span><br><span class="line">   张三	  男      	<span class="number">2021</span>/<span class="number">5</span>/<span class="number">29</span></span><br><span class="line">   李四	  男	        <span class="number">2021</span>/<span class="number">5</span>/<span class="number">29</span></span><br><span class="line">   王五	  男       	<span class="number">2021</span>/<span class="number">5</span>/<span class="number">29</span></span><br><span class="line">   赵六	  男       	<span class="number">2021</span>/<span class="number">5</span>/<span class="number">29</span></span><br><span class="line">   孙七	  男       	<span class="number">2021</span>/<span class="number">5</span>/<span class="number">29</span> </span><br><span class="line">   周八	  男       	<span class="number">2021</span>/<span class="number">5</span>/<span class="number">29</span></span><br><span class="line">   吴九	  男       	<span class="number">2021</span>/<span class="number">5</span>/<span class="number">29</span></span><br><span class="line">   郑十	  男       	<span class="number">2021</span>/<span class="number">5</span>/<span class="number">29</span></span><br></pre></td></tr></table></figure>

<h5 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//要注意这里 定义的顺序要和excel表头要对应</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="读取Excel文件"><a href="#读取Excel文件" class="headerlink" title="读取Excel文件"></a>读取<code>Excel</code>文件</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">easyExcelReadTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 这里的思想跟poi是一样的</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pathName 要读的文件的路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> head 文件中每一行数据要存储到的实体类型的class</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> readListener 读监听器，每读一行内容，都会调用一次该对象的invoke，在invoke可以操作使用读取到的数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// 1.获取一个工作簿对象，读取完之后会自动关闭</span></span><br><span class="line">    String fileName = <span class="string">"H:\\code\\poiAndExcel\\学生信息表.xlsx"</span>;</span><br><span class="line">    ExcelReaderBuilder readWorkbook = EasyExcel.read(fileName, Student<span class="class">.<span class="keyword">class</span>, <span class="title">new</span> <span class="title">StudentListener</span>())</span>;</span><br><span class="line">    <span class="comment">// 2.获取工作表对象 默认读取第一个工作表</span></span><br><span class="line">    ExcelReaderSheetBuilder sheet = readWorkbook.sheet();</span><br><span class="line">    <span class="comment">// 3.读取工作表的内容</span></span><br><span class="line">    sheet.doRead();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 以上三行代码，如果用链式编程，一行就可以实现了</span></span><br><span class="line">    <span class="comment">// EasyExcel.read(fileName,Student.class,new StudentListener()).sheet().doRead();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="读取Excel的监听器，用于处理读取产生的数据"><a href="#读取Excel的监听器，用于处理读取产生的数据" class="headerlink" title="读取Excel的监听器，用于处理读取产生的数据"></a>读取Excel的监听器，用于处理读取产生的数据</h5><p>新建listener包</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentListener</span> <span class="keyword">extends</span> <span class="title">AnalysisEventListener</span>&lt;<span class="title">Student</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读监听器，每读一行内容，都会调用一次该对象的invoke，在invoke可以操作使用读取到的数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> student 每次读取到的数据封装的对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(Student student, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"student = + "</span> + student);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取完整个文档后调用的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="简单的写"><a href="#简单的写" class="headerlink" title="简单的写"></a>简单的写</h4><h5 id="需求-1"><a href="#需求-1" class="headerlink" title="需求"></a>需求</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">单实体导出</span><br><span class="line">导出多个学生对象到Excel表格</span><br><span class="line">包含如下列：姓名、性别、出生日期</span><br></pre></td></tr></table></figure>

<h5 id="实体类-1"><a href="#实体类-1" class="headerlink" title="实体类"></a>实体类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//要注意这里 定义的顺序要和excel表头要对应，也可以用index指定</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ColumnWidth</span>(<span class="number">20</span>) <span class="comment">// 宽度</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// value表示输出的含义，index表示顺序</span></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"姓名"</span>,index = <span class="number">0</span>)</span><br><span class="line">    <span class="comment">//@ColumnWidth(10)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"出生日期"</span>,index = <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = <span class="string">"性别"</span>,index = <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ExcelProperty</span>(<span class="string">"编号"</span>)</span><br><span class="line">    <span class="meta">@ExcelIgnore</span> <span class="comment">// 不输出此字段</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="准备数据并写入文件"><a href="#准备数据并写入文件" class="headerlink" title="准备数据并写入文件"></a>准备数据并写入文件</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">easyExcelWriteTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pathName 要写入的文件路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> head 封装写入的数据的实体的类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// 1.工作簿对象</span></span><br><span class="line">    ExcelWriterBuilder writeWorkbook = EasyExcel.write(<span class="string">"写入学生信息.xlsx"</span>, Student<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="comment">// 2.工作表对象</span></span><br><span class="line">    ExcelWriterSheetBuilder sheet = writeWorkbook.sheet();</span><br><span class="line">    <span class="comment">// 3.写</span></span><br><span class="line">    sheet.doWrite(initData());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//准备的数据</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Student&gt; <span class="title">initData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ArrayList&lt;Student&gt; students = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Student student = <span class="keyword">new</span> Student();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        student.setName(<span class="string">"姓名0"</span> + i);</span><br><span class="line">        student.setBirth(<span class="keyword">new</span> Date());</span><br><span class="line">        student.setGender(<span class="string">"男"</span>);</span><br><span class="line">        students.add(student);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> students;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h5><table>
<thead>
<tr>
<th>姓名</th>
<th>性别</th>
<th>出生日期</th>
</tr>
</thead>
<tbody><tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
<tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
<tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
<tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
<tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
<tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
<tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
<tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
<tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
<tr>
<td>姓名09</td>
<td>男</td>
<td>2021-05-29 20:18:53</td>
</tr>
</tbody></table>
<h4 id="对接数据库"><a href="#对接数据库" class="headerlink" title="对接数据库"></a>对接数据库</h4><p><a href="https://www.yuque.com/easyexcel/doc/read#8e72a573" target="_blank" rel="noopener">官方Demo</a></p>
<h3 id="常用API及注解"><a href="#常用API及注解" class="headerlink" title="常用API及注解"></a>常用API及注解</h3><h4 id="常用类"><a href="#常用类" class="headerlink" title="常用类"></a>常用类</h4><ul>
<li><p><strong>EasyExcel</strong> 入口类，用于构建开始各种操作；</p>
</li>
<li><p><strong>ExcelReaderBuilder</strong> <strong>ExcelWriterBuilder</strong> 构建出一个 ReadWorkbook对象  WriteWorkbook对象，可以理解成一个excel对象(即一个工作簿对象)，对应的是一个Excel文件，一个excel只要构建一个</p>
</li>
<li><p><strong>ExcelReaderSheetBuilder</strong>  <strong>ExcelWriterSheetBuilder</strong> 构建出一个ReadSheet对象  WriteSheet对象，即一个工作表的对象，对应的Excel中的每个sheet，一个工作簿可以有多个工作表；</p>
</li>
<li><p><strong>ReadListener</strong> 在每一行读取完毕后都会调用ReadListener来处理数据，我们可以把调用<strong>service的代码</strong>可以写在其<strong>invoke</strong>方法内部；</p>
</li>
<li><p><strong>WriteHandler</strong> 在每一个操作包括创建单元格、创建表格等都会调用WriteHandler来处理数据，对使用者透明不可见；</p>
</li>
<li><p><strong>所有配置都是继承的</strong> Workbook的配置会被Sheet继承。所以在用EasyExcel设置参数的时候，在EasyExcel…sheet()方法之前作用域是整个sheet，之后针对单个sheet。</p>
<p>即：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ExcelWriterBuilder writeWorkbook = EasyExcel.write(<span class="string">"写入学生信息.xlsx"</span>, Student<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//在这里设置，因为sheet是通过writeWorkbook生成的，所以在这里配置的话，所有sheet都会生效</span></span><br><span class="line">ExcelWriterSheetBuilder sheet = writeWorkbook.sheet();</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="读取时的注解"><a href="#读取时的注解" class="headerlink" title="读取时的注解"></a>读取时的注解</h4><h5 id="ExcelProperty"><a href="#ExcelProperty" class="headerlink" title="@ExcelProperty"></a>@ExcelProperty</h5><p><strong>使用位置</strong>：标准作用在成员变量上，把实体类中的属性和excel表关联起来</p>
<p><strong>可选属性：</strong></p>
<table>
<thead>
<tr>
<th>属性名</th>
<th align="left">含义</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>index</td>
<td align="left">对应Excel表中的列数</td>
<td>默认-1，建议指定时从0开始</td>
</tr>
<tr>
<td>value</td>
<td align="left">对应Excel表中的列头</td>
<td></td>
</tr>
<tr>
<td>converter</td>
<td align="left">成员变量转换器</td>
<td>自定义转换器需要实Converter接口(类型转换，一般用不着)</td>
</tr>
</tbody></table>
<p><strong>使用效果</strong>：index属性可以指定当前字段对应excel中的哪一列，可以根据列名value去匹配，也可以不写。</p>
<p>如果不使用@ExcelProperty注解，成员变量从上到下的顺序，对应表格中从左到右的顺序；</p>
<p><strong>使用建议：</strong>要么全部不写，要么全部用index，要么全部用名字去匹配，<strong>尽量不要三个混着用</strong>。</p>
<p><strong>示例：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 修改成员变量顺序读取Excel表格</span></span><br><span class="line"><span class="comment">// 2. 修改index属性值读取Excel表格</span></span><br><span class="line"><span class="comment">// 3. 修改value属性值读取Excel表格</span></span><br></pre></td></tr></table></figure>



<h5 id="ExcelIgnore"><a href="#ExcelIgnore" class="headerlink" title="@ExcelIgnore"></a>@ExcelIgnore</h5><p>标注在成员变量上，默认所有字段都会和excel去匹配，加了这个注解会忽略该字段</p>
<p> <strong>代码演示：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. 忽略id成员变量值读取Excel表格</span></span><br></pre></td></tr></table></figure>

<h5 id="DateTimeFormat"><a href="#DateTimeFormat" class="headerlink" title="@DateTimeFormat"></a>@DateTimeFormat</h5><p>标注在成员变量上，日期转换，代码中用<code>String类型的成员变量</code>去接收<code>excel中日期格式的数据</code>会调用这个注解。里面的<code>value</code>参照<code>java.text.SimpleDateFormat</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5. 按照指定的格式写入Excel内容</span></span><br><span class="line"> <span class="meta">@DateTimeFormat</span>(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br></pre></td></tr></table></figure>

<h5 id="NumberFormat"><a href="#NumberFormat" class="headerlink" title="@NumberFormat"></a>@NumberFormat</h5><p>标注在成员变量上，数字转换，代码中用<code>String类型的成员变量</code>去接收<code>excel数字格式的数据</code>会调用这个注解。里面的<code>value</code>参照<code>java.text.DecimalFormat</code></p>
<h4 id="读取时通用参数"><a href="#读取时通用参数" class="headerlink" title="读取时通用参数"></a>读取时通用参数</h4><p><code>ReadWorkbook</code>,<code>ReadSheet</code> 都会有的参数，如果为空，默认使用上级。</p>
<ul>
<li><code>converter</code> 转换器，默认加载了很多转换器。也可以自定义。</li>
<li><code>readListener</code> 监听器，在读取数据的过程中会不断的调用监听器。</li>
<li><code>headRowNumber</code> 指定需要读表格的 列头行数。默认有一行头，也就是认为第二行开始起为数据。</li>
<li><code>head</code> 与<code>clazz</code>二选一。读取文件头对应的列表，会根据列表匹配数据。建议使用clas，就是文件中每一行数据对应的代码中的实体类型。</li>
<li><code>clazz</code> 与<code>head</code>二选一。读取文件的头对应的class，也可以使用注解。如果两个都不指定，则会读取全部数据。</li>
<li><code>autoTrim</code> 字符串、表头等数据自动trim</li>
<li><code>password</code> 读的时候是否需要使用密码</li>
</ul>
<h3 id="ReadWorkbook（工作簿对象）参数"><a href="#ReadWorkbook（工作簿对象）参数" class="headerlink" title="ReadWorkbook（工作簿对象）参数"></a>ReadWorkbook（工作簿对象）参数</h3><ul>
<li><code>excelType</code> 当前excel的类型，读取时会自动判断，无需设置。</li>
<li><code>inputStream</code> 与<code>file</code>二选一。建议使用file。</li>
<li><code>file</code> 与<code>inputStream</code>二选一。读取文件的文件。</li>
<li><code>autoCloseStream</code> 自动关闭流。</li>
<li><code>readCache</code> 默认小于5M用 内存，超过5M会使用 <code>EhCache</code>，不建议使用这个参数。</li>
<li><code>useDefaultListener</code> <code>@since 2.1.4</code> 默认会加入<code>ModelBuildEventListener</code> 来帮忙转换成传入<code>class</code>的对象，设置成<code>false</code>后将不会协助转换对象，自定义的监听器会接收到<code>Map&lt;Integer,CellData&gt;</code>对象，如果还想继续接听到<code>class</code>对象，请调用<code>readListener</code>方法，加入自定义的<code>beforeListener</code>、 <code>ModelBuildEventListener</code>、 自定义的<code>afterListener</code>即可。</li>
</ul>
<h3 id="5、ReadSheet（工作表对象）参数"><a href="#5、ReadSheet（工作表对象）参数" class="headerlink" title="5、ReadSheet（工作表对象）参数"></a>5、ReadSheet（工作表对象）参数</h3><ul>
<li><code>sheetNo</code> 需要读取Sheet的编号，建议使用这个来指定读取哪个Sheet</li>
<li><code>sheetName</code> 根据名字去匹配Sheet，excel 2003不支持根据名字去匹配</li>
</ul>
<h3 id="6、写入时的注解注解"><a href="#6、写入时的注解注解" class="headerlink" title="6、写入时的注解注解"></a>6、写入时的注解注解</h3><h4 id="ExcelProperty-1"><a href="#ExcelProperty-1" class="headerlink" title="@ExcelProperty"></a>@ExcelProperty</h4><p><strong>使用位置</strong>：标准作用在成员变量上</p>
<p><strong>可选属性：</strong></p>
<table>
<thead>
<tr>
<th>属性名</th>
<th align="left">含义</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>index</td>
<td align="left">对应Excel表中的列数</td>
<td>默认-1，指定时建议从0开始</td>
</tr>
<tr>
<td>value</td>
<td align="left">对应Excel表中的列头</td>
<td></td>
</tr>
<tr>
<td>converter</td>
<td align="left">成员变量转换器</td>
<td>自定义转换器需要实Converter接口</td>
</tr>
</tbody></table>
<p><strong>使用效果</strong>：<code>index</code> 指定写到第几列，如果不指定则根据成员变量位置排序；</p>
<p>​                     <code>value</code>指定写入的列头，如果不指定则使用成员变量的名字作为列头；</p>
<p>​                    如果要设置复杂的头，可以为value指定多个值。</p>
<p><strong>代码演示：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5. 为《杭州黑马学员表.xlsx》文件中学生信息设置一个统一的表头“杭州黑马学员信息表”</span></span><br></pre></td></tr></table></figure>

<h4 id="其他注解："><a href="#其他注解：" class="headerlink" title="其他注解："></a>其他注解：</h4><p>基本和读取时一致</p>
<ul>
<li><p>@ContentRowHeight()    标注在类上或属性上，指定内容行高</p>
</li>
<li><p>@HeadRowHeight()  标注在类上或属性上，指定列头行高</p>
</li>
<li><p>@ColumnWidth() 标注在类上或属性上，指定列宽</p>
</li>
<li><p>ExcelIgnore` 默认所有字段都会写入excel，这个注解会忽略这个字段</p>
</li>
<li><p><code>DateTimeFormat</code> 日期转换，将<code>Date</code>写到excel会调用这个注解。里面的<code>value</code>参照<code>java.text.SimpleDateFormat</code></p>
</li>
<li><p><code>NumberFormat</code> 数字转换，用<code>Number</code>写excel会调用这个注解。里面的<code>value</code>参照<code>java.text.DecimalFormat</code></p>
</li>
<li><p><code>ExcelIgnoreUnannotated</code> 默认不加 <code>ExcelProperty</code> 的注解的都会参与读写，加了不会参与</p>
</li>
</ul>
<h3 id="7、写入时通用参数"><a href="#7、写入时通用参数" class="headerlink" title="7、写入时通用参数"></a>7、写入时通用参数</h3><p><code>WriteWorkbook</code>、<code>WriteSheet</code>都会有的参数，如果为空，默认使用上级。</p>
<ul>
<li><p><code>converter</code> 转换器，默认加载了很多转换器。也可以自定义。</p>
</li>
<li><p><code>writeHandler</code> 写的处理器。可以实现<code>WorkbookWriteHandler</code>,<code>SheetWriteHandler</code>,<code>RowWriteHandler</code>,<code>CellWriteHandler</code>，在写入excel的不同阶段会调用，对使用者透明不可见。</p>
</li>
<li><p><code>relativeHeadRowIndex</code> 距离多少行后开始。也就是开头空几行</p>
</li>
<li><p><code>needHead</code> 是否导出头</p>
</li>
<li><p><code>head</code> 与<code>clazz</code>二选一。写入文件的头列表，建议使用class。</p>
</li>
<li><p><code>clazz</code> 与<code>head</code>二选一。写入文件的头对应的class，也可以使用注解。</p>
</li>
<li><p><code>autoTrim</code>  字符串、表头等数据自动trim</p>
</li>
</ul>
<h3 id="8、WriteWorkbook（工作簿对象）参数"><a href="#8、WriteWorkbook（工作簿对象）参数" class="headerlink" title="8、WriteWorkbook（工作簿对象）参数"></a>8、WriteWorkbook（工作簿对象）参数</h3><ul>
<li><p><code>excelType</code> 当前excel的类型，默认为<code>xlsx</code></p>
</li>
<li><p><code>outputStream</code> 与<code>file</code>二选一。写入文件的流</p>
</li>
<li><p><code>file</code> 与<code>outputStream</code>二选一。写入的文件</p>
</li>
<li><p><code>templateInputStream</code> 模板的文件流</p>
</li>
<li><p><code>templateFile</code> 模板文件</p>
</li>
<li><p><code>autoCloseStream</code> 自动关闭流。</p>
</li>
<li><p><code>password</code>  写的时候是否需要使用密码</p>
</li>
<li><p><code>useDefaultStyle</code> 写的时候是否是使用默认头</p>
</li>
</ul>
<h3 id="9、WriteSheet（工作表对象）参数"><a href="#9、WriteSheet（工作表对象）参数" class="headerlink" title="9、WriteSheet（工作表对象）参数"></a>9、WriteSheet（工作表对象）参数</h3><ul>
<li><p><code>sheetNo</code> 需要写入的编号。默认0</p>
</li>
<li><p><code>sheetName</code> 需要些的Sheet名称，默认同sheetNo</p>
</li>
</ul>
<h2 id="easyExcel实战"><a href="#easyExcel实战" class="headerlink" title="easyExcel实战"></a>easyExcel实战</h2><p>通过下载好的模块，把数据导入数据库</p>
<p>效果图：</p>
<p><img src="https://easyexcelimages.oss-cn-beijing.aliyuncs.com/excel%E6%A8%A1%E6%9D%BF%E5%9B%BE.png" alt></p>
<p>导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="模板下载"><a href="#模板下载" class="headerlink" title="模板下载"></a>模板下载</h3><ol>
<li><p>WriteExcel 实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WriteExcel</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String bigTitle= <span class="string">"填写须知： \n"</span> +</span><br><span class="line">            <span class="string">"1.第1、2行为固定结构，不可更改\n"</span> +</span><br><span class="line">            <span class="string">"2.请严格按照填写规则输入数据，不合规的数据无法成功导入\n"</span> +</span><br><span class="line">            <span class="string">"3.无特殊说明则为必填项"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"工号"</span>)</span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> Integer employeeNumber;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"职位编号"</span>)</span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String positionId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"员工编号"</span>)</span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String employeeId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"姓名"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"姓名"</span>&#125;,index = <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">private</span> String employeeName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"性别"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"性别"</span>&#125;,index = <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">private</span> String employeeGender;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"手机号码"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"手机号码"</span>&#125;,index = <span class="number">2</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">private</span> String employeePhone;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"邮箱"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"邮箱"</span>&#125;,index = <span class="number">3</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">18</span>)</span><br><span class="line">    <span class="keyword">private</span> String employeeEmail;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"出生年月日"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"出生年月日\n(格式:yyyy-MM-dd)"</span>&#125;,index = <span class="number">4</span>)</span><br><span class="line">    <span class="meta">@DateTimeFormat</span>(value = <span class="string">"yyyy-MM-dd"</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">private</span> String employeeBirth;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"毕业院校"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"毕业院校"</span>&#125;,index = <span class="number">5</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">private</span> String employeeGraduateCollege;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"身份证号码"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"身份证号码"</span>&#125;,index = <span class="number">6</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">private</span> String employeeIdCard;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"员工状态"</span>&#125;,index = <span class="number">7</span>)</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"员工状态"</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer employeeStatus;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"职位"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"职位"</span>&#125;,index = <span class="number">8</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">private</span> String positionName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"角色"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"角色"</span>&#125;,index = <span class="number">9</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer role;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"部门"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"部门"</span>&#125;,index = <span class="number">10</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">private</span> String departmentName;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"部门负责人\n(没有就填无)"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"部门负责人\n(没有就填无)"</span>&#125;,index = <span class="number">11</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">15</span>)</span><br><span class="line">    <span class="keyword">private</span> String leaderName;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"入职时间"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"入职时间\n(格式:yyyy/MM/dd HH:mm)"</span>&#125;,index = <span class="number">12</span>)</span><br><span class="line">    <span class="meta">@DateTimeFormat</span>(value = <span class="string">"yyyy-MM-dd HH:mm:ss"</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">private</span> String gmtCreate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"详细住址"</span>)</span><br><span class="line">    <span class="meta">@ExcelProperty</span>(value = &#123;bigTitle,<span class="string">"详细住址(省、市、区/县、街道/镇)"</span>&#125;,index = <span class="number">13</span>)</span><br><span class="line">    <span class="meta">@ColumnWidth</span>(<span class="number">50</span>)</span><br><span class="line">    <span class="keyword">private</span> String employeeDetailAddress;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"省份"</span>)</span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String employeeProvinceAddress;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"城市"</span>)</span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String employeeCityAddress;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"区/县"</span>)</span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String employeeDistrictAddress;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"街道/镇"</span>)</span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String employeeStreetAddress;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载模板controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(value = <span class="string">"/getDemo"</span>)</span><br><span class="line"><span class="meta">@ApiOperation</span>(value = <span class="string">"下载模板"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getDemo</span><span class="params">(HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        String fileName = <span class="string">"导入模板"</span>;</span><br><span class="line">        String sheetName = <span class="string">"员工信息表"</span>;</span><br><span class="line">        <span class="comment">// 表头的策略</span></span><br><span class="line">        WriteCellStyle headWriteCellStyle = <span class="keyword">new</span> WriteCellStyle();</span><br><span class="line">        <span class="comment">// 内容的策略</span></span><br><span class="line">        WriteCellStyle contentWriteCellStyle = <span class="keyword">new</span> WriteCellStyle();</span><br><span class="line">        <span class="comment">// 这个策略是 头是头的样式 内容是内容的样式 其他的策略可以自己实现</span></span><br><span class="line">        HorizontalCellStyleStrategy horizontalCellStyleStrategy = <span class="keyword">new</span> HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);</span><br><span class="line">        </span><br><span class="line">        response.setContentType(<span class="string">"application/vnd.ms-excel"</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">        <span class="comment">// 这里URLEncoder.encode可以防止中文乱码</span></span><br><span class="line">        fileName = URLEncoder.encode(fileName, <span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Content-disposition"</span>, <span class="string">"attachment;filename*=utf-8''"</span> + fileName + <span class="string">".xlsx"</span>);</span><br><span class="line">        </span><br><span class="line">        EasyExcel.write(response.getOutputStream(), ReadExcel<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">                .<span class="title">excelType</span>(<span class="title">ExcelTypeEnum</span>.<span class="title">XLSX</span>)</span></span><br><span class="line"><span class="class">                .<span class="title">registerWriteHandler</span>(<span class="title">horizontalCellStyleStrategy</span>)</span></span><br><span class="line"><span class="class">            	// 这里如果直接设置自己定义的，没有上一行代码，没效果，相反，如果跟在整体设置策略后面，这样就有效果了</span></span><br><span class="line"><span class="class">                .<span class="title">registerWriteHandler</span>(<span class="title">new</span> <span class="title">CustomizeCellWriteHandler</span>(75))</span></span><br><span class="line"><span class="class">                .<span class="title">registerWriteHandler</span>(<span class="title">new</span> <span class="title">CustomizeSheetWriteHandler</span>())</span></span><br><span class="line"><span class="class">                .<span class="title">sheet</span>(<span class="title">sheetName</span>)</span></span><br><span class="line"><span class="class">                .<span class="title">doWrite</span>(<span class="title">new</span> <span class="title">ArrayList</span>())</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        log.error(<span class="string">"导出异常，e: &#123;&#125;"</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>自定义单元格样式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomizeCellWriteHandler</span> <span class="keyword">implements</span> <span class="title">CellWriteHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模板的首行行高 ，通过构造器注入</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> height;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomizeCellWriteHandler</span><span class="params">(<span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeCellCreate</span><span class="params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Row row, Head head, Integer columnIndex, Integer relativeRowIndex, Boolean isHead)</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCellCreate</span><span class="params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead)</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCellDataConverted</span><span class="params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, CellData cellData, Cell cell, Head head, Integer integer, Boolean aBoolean)</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCellDispose</span><span class="params">(WriteSheetHolder writeSheetHolder,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 WriteTableHolder writeTableHolder,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 List&lt;CellData&gt; cellDataList,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 Cell cell,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 Head head,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 Integer relativeRowIndex,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 Boolean isHead)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Workbook workbook = writeSheetHolder.getSheet().getWorkbook();</span><br><span class="line">        CellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">        cellStyle.setFillForegroundColor(IndexedColors.GREY_25_PERCENT.getIndex());</span><br><span class="line">        cellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line">        cellStyle.setBorderLeft(BorderStyle.THIN);</span><br><span class="line">        cellStyle.setBorderTop(BorderStyle.THIN);</span><br><span class="line">        cellStyle.setBorderRight(BorderStyle.THIN);</span><br><span class="line">        cellStyle.setBorderBottom(BorderStyle.THIN);</span><br><span class="line">        Font font = workbook.createFont();</span><br><span class="line">        <span class="comment">// 序号为1的行</span></span><br><span class="line">        <span class="keyword">if</span> (cell.getRowIndex() == <span class="number">0</span>) &#123;</span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">12</span>);</span><br><span class="line">            font.setFontName(<span class="string">"微软雅黑"</span>);</span><br><span class="line">            <span class="comment">// 加粗</span></span><br><span class="line">            font.setBold(<span class="keyword">true</span>);</span><br><span class="line">            cellStyle.setFont(font);</span><br><span class="line">            <span class="comment">// 水平垂直居中</span></span><br><span class="line">            cellStyle.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">            cellStyle.setVerticalAlignment(VerticalAlignment.CENTER);</span><br><span class="line">            cellStyle.setFillBackgroundColor((<span class="keyword">short</span>)<span class="number">20</span>);</span><br><span class="line">            <span class="comment">// 自动换行</span></span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);</span><br><span class="line">            Row row = cell.getRow();</span><br><span class="line">            row.setHeightInPoints(height);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cell.getRowIndex() == <span class="number">1</span>) &#123;</span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">11</span>);</span><br><span class="line">            font.setFontName(<span class="string">"宋体"</span>);</span><br><span class="line">            font.setBold(<span class="keyword">true</span>);</span><br><span class="line">            cellStyle.setFont(font);</span><br><span class="line">            cellStyle.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">            cellStyle.setVerticalAlignment(VerticalAlignment.CENTER);</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        cell.setCellStyle(cellStyle);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>单元格下拉框设置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomizeSheetWriteHandler</span> <span class="keyword">implements</span> <span class="title">SheetWriteHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeSheetCreate</span><span class="params">(WriteWorkbookHolder writeWorkbookHolder, WriteSheetHolder writeSheetHolder)</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建sheet页后的操作，设置下拉框</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterSheetCreate</span><span class="params">(WriteWorkbookHolder writeWorkbookHolder, WriteSheetHolder writeSheetHolder)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 根据index，形成map，可插入多个</span></span><br><span class="line">        Map&lt;Integer,String []&gt; mapDropDown = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="comment">// 性别选值范围</span></span><br><span class="line">        String[] genders = <span class="keyword">new</span> String[]&#123;<span class="string">"男"</span>,<span class="string">"女"</span>&#125;;</span><br><span class="line">        <span class="comment">// 角色选值范围</span></span><br><span class="line">        String[] roles = <span class="keyword">new</span> String[]&#123;<span class="string">"超级管理员"</span>,<span class="string">"HR"</span>,<span class="string">"组长"</span>,<span class="string">"员工"</span>,<span class="string">"系统维护人员"</span>&#125;;</span><br><span class="line">        <span class="comment">// 得到全部职位</span></span><br><span class="line">        PositionServiceImpl positionServiceImpl = (PositionServiceImpl) SpringBeanUtil.getBean(<span class="string">"positionServiceImpl"</span>);</span><br><span class="line"></span><br><span class="line">        QueryWrapper&lt;Position&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        wrapper.select(<span class="string">"position_name"</span>).eq(<span class="string">"department_id"</span>,<span class="number">1</span>).eq(<span class="string">"parent_id"</span>,<span class="number">0</span>);</span><br><span class="line">        List&lt;Position&gt; positionList = positionServiceImpl.list(wrapper);</span><br><span class="line">        String[] positions = <span class="keyword">new</span> String[positionList.size()];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; positionList.size(); i++) &#123;</span><br><span class="line">            positions[i] = positionList.get(i).getPositionName();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 员工状态</span></span><br><span class="line">        String[] employeeStatus = <span class="keyword">new</span> String[]&#123;<span class="string">"试用"</span>,<span class="string">"正式"</span>,<span class="string">"实习"</span>,<span class="string">"交接"</span>,<span class="string">"离职"</span>,<span class="string">"派遣"</span>,<span class="string">"跨部门"</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 下拉框选择的位置</span></span><br><span class="line">        mapDropDown.put(<span class="number">1</span>,genders);</span><br><span class="line">        mapDropDown.put(<span class="number">7</span>,employeeStatus);</span><br><span class="line">        mapDropDown.put(<span class="number">8</span>,positions);</span><br><span class="line">        mapDropDown.put(<span class="number">9</span>,roles);</span><br><span class="line">        <span class="comment">// 获取sheet页</span></span><br><span class="line">        Sheet sheet = writeSheetHolder.getSheet();</span><br><span class="line">        <span class="comment">// 设置下拉框</span></span><br><span class="line">        DataValidationHelper helper = sheet.getDataValidationHelper();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;Integer, String[]&gt; entry : mapDropDown.entrySet()) &#123;</span><br><span class="line">            <span class="comment">// 起始行、终止行、起始列、终止列</span></span><br><span class="line">            CellRangeAddressList addressList = <span class="keyword">new</span> CellRangeAddressList(<span class="number">1</span>, <span class="number">30</span>, entry.getKey(), entry.getKey());</span><br><span class="line">            <span class="comment">// 设置下拉框数据</span></span><br><span class="line">            DataValidationConstraint constraint = helper.createExplicitListConstraint(entry.getValue());</span><br><span class="line">            DataValidation dataValidation = helper.createValidation(constraint, addressList);</span><br><span class="line">            <span class="comment">// 处理Excel兼容性问题</span></span><br><span class="line">            <span class="keyword">if</span> (dataValidation <span class="keyword">instanceof</span> XSSFDataValidation) &#123;</span><br><span class="line">                dataValidation.setSuppressDropDownArrow(<span class="keyword">true</span>);</span><br><span class="line">                dataValidation.setShowErrorBox(<span class="keyword">true</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                dataValidation.setSuppressDropDownArrow(<span class="keyword">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            sheet.addValidationData(dataValidation);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="读取excel模板"><a href="#读取excel模板" class="headerlink" title="读取excel模板"></a>读取excel模板</h3><ol>
<li><p>上传excel</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/upload"</span>)</span><br><span class="line"><span class="meta">@ApiOperation</span>(value = <span class="string">"excel导入员工信息"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">easyExcelReadTest</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    EasyExcel.read(file.getInputStream(), ReadExcel<span class="class">.<span class="keyword">class</span>,<span class="title">new</span> <span class="title">EmployeeDataListener</span>(<span class="title">null</span>,<span class="title">WriteExcel</span>.<span class="title">class</span>)).<span class="title">sheet</span>().<span class="title">doRead</span>()</span>;</span><br><span class="line">    <span class="keyword">return</span> Result.ok().message(<span class="string">"上传成功"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>监听器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 写入excel调用的监听器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 黄炳培</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2021/6/4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeDataListener</span> <span class="keyword">extends</span> <span class="title">AnalysisEventListener</span>&lt;<span class="title">ReadExcel</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 每隔20条存储数据库，然后清理list ，方便内存回收</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BATCH_COUNT = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对应实体类字段，用来获取实体类中的ExcelProperty注解中的val值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Integer, String&gt; modelHead;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * class对象，用作反射</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Class classz;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    List&lt;ReadExcel&gt; readExcelList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EmployeeDataListener</span><span class="params">(Map&lt;Integer, String&gt; headMap, Class c)</span> </span>&#123;</span><br><span class="line">        modelHead = headMap;</span><br><span class="line">        classz = c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 校验表头</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> headMap</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invokeHeadMap</span><span class="params">(Map&lt;Integer, String&gt; headMap, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == modelHead) &#123;</span><br><span class="line">            modelHead = getIndexNameMap(classz);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(modelHead)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (context.readRowHolder().getRowIndex() == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; headMap.size(); i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!headMap.get(i).equals(modelHead.get(i))) &#123;</span><br><span class="line">                    log.info(<span class="string">"第&#123;&#125;列表头格式有误!!"</span>,i);</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> EmployeeException(<span class="number">20001</span>,<span class="string">"第"</span>+i+<span class="string">"列表头格式有误!!"</span>+<span class="string">" 请使用模板文件导入！"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 每一条数据解析都会来调用</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(ReadExcel data, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"解析到一条数据:&#123;&#125;"</span>, JSON.toJSONString(data));</span><br><span class="line">        readExcelList.add(data);</span><br><span class="line">        <span class="keyword">if</span> (readExcelList.size() &gt;= BATCH_COUNT) &#123;</span><br><span class="line">            saveData();</span><br><span class="line">            <span class="comment">// 存储完成清理 list</span></span><br><span class="line">            readExcelList.clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当所有数据都解析完成了，才会来调用</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (readExcelList.size() != <span class="number">0</span>) &#123;</span><br><span class="line">            saveData();</span><br><span class="line">            readExcelList.clear();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 除了表头之外，没有其他数据时，抛出异常</span></span><br><span class="line">        <span class="keyword">if</span> (context.getTotalCount() == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> EmployeeException(<span class="number">20001</span>,<span class="string">"模板数据为空!!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 导入数据完成后，重置计数器</span></span><br><span class="line">        ExcelServiceImpl excelServiceImpl = (ExcelServiceImpl) SpringBeanUtil.getBean(<span class="string">"excelServiceImpl"</span>);</span><br><span class="line">        excelServiceImpl.resetCount();</span><br><span class="line">        log.info(<span class="string">"所有数据解析完毕"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">saveData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ExcelServiceImpl excelServiceImpl = (ExcelServiceImpl) SpringBeanUtil.getBean(<span class="string">"excelServiceImpl"</span>);</span><br><span class="line">        log.info(<span class="string">"&#123;&#125;条数据，开始存储数据库！"</span>, readExcelList.size());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            excelServiceImpl.saveBatchData(readExcelList);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (DataAccessException e) &#123;</span><br><span class="line">            String property = getFieldExcelProperty(String.valueOf(e.getCause()));</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> EmployeeException(<span class="number">20001</span>,property + <span class="string">"这一列不能为空"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (EmployeeException e) &#123;</span><br><span class="line">            log.info(e.getMsg());</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> EmployeeException(e.getCode(),e.getMsg());</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"存储数据库成功！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过反射来获取对象的ExcelProperty中的val，用作校验表头</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NoSuchFieldException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;Integer, String&gt; <span class="title">getIndexNameMap</span><span class="params">(Class clazz)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Map&lt;Integer, String&gt; ExcelHeadField = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Field field = <span class="keyword">null</span>;</span><br><span class="line">        Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fields.length; i++) &#123;</span><br><span class="line">            field = clazz.getDeclaredField(fields[i].getName());</span><br><span class="line">            field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            ExcelProperty excelProperty = field.getAnnotation(ExcelProperty<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span> (excelProperty != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> index = excelProperty.index();</span><br><span class="line">                String[] values = excelProperty.value();</span><br><span class="line">                String feildName = values[<span class="number">1</span>];</span><br><span class="line">                ExcelHeadField.put(index, feildName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ExcelHeadField;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过属性名获取ApiModelProperty中的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> exceptionMsg</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getFieldExcelProperty</span><span class="params">(String exceptionMsg)</span></span>&#123;</span><br><span class="line">        ReadExcel readExcel = <span class="keyword">new</span> ReadExcel();</span><br><span class="line">        <span class="keyword">int</span> start = exceptionMsg.indexOf(<span class="string">"'"</span>);</span><br><span class="line">        <span class="keyword">int</span> end = exceptionMsg.indexOf(<span class="string">"'"</span>, start + <span class="number">1</span>);</span><br><span class="line">        String ColumnName = exceptionMsg.substring(start + <span class="number">1</span>, end);</span><br><span class="line">        ArrayList&lt;Character&gt; fieNamelist = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">char</span>[] chars = ColumnName.toCharArray();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ColumnName.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">'_'</span> == chars[i]) &#123;</span><br><span class="line">                <span class="comment">// 下划线的下一个字母需要大写</span></span><br><span class="line">                chars[i+<span class="number">1</span>] = Character.toUpperCase(chars[i+<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            fieNamelist.add(chars[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        StringBuilder fieldName = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;fieNamelist.size(); i++) &#123;</span><br><span class="line">            fieldName.append(fieNamelist.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Field field = readExcel.getClass().getDeclaredField(fieldName.toString());</span><br><span class="line">            field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            ApiModelProperty apiModelProperty = field.getAnnotation(ApiModelProperty<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            <span class="keyword">return</span> apiModelProperty.value();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>属性转换器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 角色名-整型字符型转换器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomRoleConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Class <span class="title">supportJavaTypeKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Integer<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CellDataTypeEnum <span class="title">supportExcelTypeKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> CellDataTypeEnum.STRING;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 这里读的时候会调用</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cellData</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> contentProperty</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> globalConfiguration</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">convertToJavaData</span><span class="params">(CellData cellData, ExcelContentProperty contentProperty, GlobalConfiguration globalConfiguration)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String role = cellData.getStringValue();</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"超级管理员"</span>.equals(role)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"员工"</span>.equals(role)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"组长"</span>.equals(role)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"HR"</span>.equals(role)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 系统维护人员</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CellData <span class="title">convertToExcelData</span><span class="params">(Integer value, ExcelContentProperty contentProperty, GlobalConfiguration globalConfiguration)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>

      <blockquote class="mdui-m-t-5">
        
          <strong>本文遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC BY-NC-SA 4.0</a> 许可协议，转载请附上原文出处链接和本声明。</strong><br>
        
        <strong>本文链接：</strong><a href="https://yellowbp.github.io/2021/05/29/POI和easyExcel/">https://yellowbp.github.io/2021/05/29/POI和easyExcel/</a>
      </blockquote>
      
    </div>
    <footer class="mdui-card-actions">
      
        <a class="mdui-ripple article_categories-link" href="/categories/技术/">技术</a>
      
      
        <a class="mdui-ripple article_tags-link" href="/tags/excel/">excel</a>
      
    </footer>
    
  </article>
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script>$("#main article .mdui-card-content img.fancybox").on("click",function(e){$.fancybox.open({src:$(this).attr("src")});});</script>


  <nav id="paginator">
    
      <a rel="prev" class="extend prev" href="/2021/06/01/SpringSecurity/">
        <button aria-label="prev" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_back</i></button>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;上一篇
      </a>
    
    <div class="spacer"></div>
    
      <a rel="next" class="extend next" href="/2021/05/08/Swagger2/">
        下一篇&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <button aria-label="next" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_forward</i></button>
      </a>
    
  </nav>


  <div id="comment" class="mdui-m-t-5">
    <style>#pop_ad,#feedAv{display:none!important;position:absolute!important;z-index:-9999;left:-1000px;opacity:0!important}</style>
<div id="SOHUCS" sid="ckrq6a4f4005rectwhbl0glru"></div>
<script type="text/javascript">
(function(){
var appid = 'cyubhC2Dq';
var conf = 'prod_e4cce65003c5bed049fefcb8a6f09e12';
var width = window.innerWidth || document.documentElement.clientWidth;
if (width < 960) {
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("http://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>
  </div>



  <div style="position: fixed !important; right: 16px; top: 30%;">
    <button class="mdui-fab mdui-fab-mini mdui-ripple" mdui-menu="{target: '#toc'}"><i class="mdui-icon material-icons">format_list_numbered</i></button>
    <ul class="mdui-menu" id="toc">
      <li class="mdui-menu-item" disabled><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#POI和easyExcel"><span class="toc-number">1.</span> <span class="toc-text">POI和easyExcel</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#应用场景"><span class="toc-number">1.1.</span> <span class="toc-text">应用场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Excel格式分析格式分析"><span class="toc-number">1.2.</span> <span class="toc-text">Excel格式分析格式分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组件对比"><span class="toc-number">1.3.</span> <span class="toc-text">组件对比</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#POI"><span class="toc-number">1.3.1.</span> <span class="toc-text">POI</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Excel读写时候内存溢出"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">Excel读写时候内存溢出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用复杂和学习成本"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">使用复杂和学习成本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#基本类功能"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">基本类功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#特点"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyExcel"><span class="toc-number">1.3.2.</span> <span class="toc-text">easyExcel</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#重写了POI对07版Excel的解析"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">重写了POI对07版Excel的解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#特点-1"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">特点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POI-1"><span class="toc-number">1.4.</span> <span class="toc-text">POI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#excel写"><span class="toc-number">1.4.1.</span> <span class="toc-text">excel写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图片"><span class="toc-number">1.4.2.</span> <span class="toc-text">图片</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#03版本："><span class="toc-number">1.4.2.1.</span> <span class="toc-text">03版本：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#07版本："><span class="toc-number">1.4.2.2.</span> <span class="toc-text">07版本：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Excel读"><span class="toc-number">1.4.3.</span> <span class="toc-text">Excel读</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#03版本"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">03版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#07版本"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">07版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#读取不同的数据类型（大头），下次使用可以直接cv"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">读取不同的数据类型（大头），下次使用可以直接cv</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#计算公式"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">计算公式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyExcel-1"><span class="toc-number">1.5.</span> <span class="toc-text">easyExcel</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Demo"><span class="toc-number">1.5.1.</span> <span class="toc-text">Demo</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#导入依赖"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">导入依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简单读"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">简单读</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#需求"><span class="toc-number">1.5.1.2.1.</span> <span class="toc-text">需求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#实体类"><span class="toc-number">1.5.1.2.2.</span> <span class="toc-text">实体类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#读取Excel文件"><span class="toc-number">1.5.1.2.3.</span> <span class="toc-text">读取Excel文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#读取Excel的监听器，用于处理读取产生的数据"><span class="toc-number">1.5.1.2.4.</span> <span class="toc-text">读取Excel的监听器，用于处理读取产生的数据</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简单的写"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">简单的写</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#需求-1"><span class="toc-number">1.5.1.3.1.</span> <span class="toc-text">需求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#实体类-1"><span class="toc-number">1.5.1.3.2.</span> <span class="toc-text">实体类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#准备数据并写入文件"><span class="toc-number">1.5.1.3.3.</span> <span class="toc-text">准备数据并写入文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#结果"><span class="toc-number">1.5.1.3.4.</span> <span class="toc-text">结果</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#对接数据库"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">对接数据库</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常用API及注解"><span class="toc-number">1.5.2.</span> <span class="toc-text">常用API及注解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#常用类"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">常用类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#读取时的注解"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">读取时的注解</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ExcelProperty"><span class="toc-number">1.5.2.2.1.</span> <span class="toc-text">@ExcelProperty</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ExcelIgnore"><span class="toc-number">1.5.2.2.2.</span> <span class="toc-text">@ExcelIgnore</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#DateTimeFormat"><span class="toc-number">1.5.2.2.3.</span> <span class="toc-text">@DateTimeFormat</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NumberFormat"><span class="toc-number">1.5.2.2.4.</span> <span class="toc-text">@NumberFormat</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#读取时通用参数"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">读取时通用参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReadWorkbook（工作簿对象）参数"><span class="toc-number">1.5.3.</span> <span class="toc-text">ReadWorkbook（工作簿对象）参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、ReadSheet（工作表对象）参数"><span class="toc-number">1.5.4.</span> <span class="toc-text">5、ReadSheet（工作表对象）参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6、写入时的注解注解"><span class="toc-number">1.5.5.</span> <span class="toc-text">6、写入时的注解注解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ExcelProperty-1"><span class="toc-number">1.5.5.1.</span> <span class="toc-text">@ExcelProperty</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#其他注解："><span class="toc-number">1.5.5.2.</span> <span class="toc-text">其他注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7、写入时通用参数"><span class="toc-number">1.5.6.</span> <span class="toc-text">7、写入时通用参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8、WriteWorkbook（工作簿对象）参数"><span class="toc-number">1.5.7.</span> <span class="toc-text">8、WriteWorkbook（工作簿对象）参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9、WriteSheet（工作表对象）参数"><span class="toc-number">1.5.8.</span> <span class="toc-text">9、WriteSheet（工作表对象）参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyExcel实战"><span class="toc-number">1.6.</span> <span class="toc-text">easyExcel实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#模板下载"><span class="toc-number">1.6.1.</span> <span class="toc-text">模板下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#读取excel模板"><span class="toc-number">1.6.2.</span> <span class="toc-text">读取excel模板</span></a></li></ol></li></ol></li></ol></li>
    </ul>
  </div>
</main>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<footer id="footer" class="mdui-m-t-5 mdui-p-y-3 mdui-color-theme">
  <div class="mdui-p-y-0 mdui-text-center">
    
    
    
    
    
    
    
      <a href="https://github.com/yellowbp" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe7ab;</i></a>
    
    
    
    
    
      <a href="tencent://message/?uin=1432440963&Menu=yes" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe651;</i></a>
    
    
  </div>
  <div class="mdui-p-y-1 mdui-text-center">
    Copyright &copy; 2019 - 2021 hbp<br>
    Powered by <a href="https://hexo.io/" target="_blank" class="mdui-text-color-theme-accent">Hexo</a>hbp All rights reserved.
    
    <br>
    <span id="busuanzi_container_site_uv">
    本网站总访问量<span id="busuanzi_value_site_uv"></span>次
    </span>
  </div>
</footer>
  <button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-theme-accent"><i class="mdui-icon material-icons">arrow_upward</i></button>
  <script async src="http://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <script src="/js/mdui.js"></script>
<script src="/js/script.js"></script>
</body>
</html>