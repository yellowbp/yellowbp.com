<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <meta name="renderer" content="webkit">

  
  <title>jenkins | bp的Blog</title>

  <link rel="shortcut icon" href="/images/favicon.png">
  
  <meta name="description" content="jenkins持续集成持续集成（Continuous integration ， 简称 CI）指的是，频繁地（一天多次）将代码集成到主干(远程仓库)。 集成：集成的是团队的代码，而不是某个开发者的代码 持续集成的目的，就是让产品可以快速迭代，同时还能保持高质量。它的核心措施是，代码集成到主干之前，必须通过自动化测试。只要有一个测试用例失败，就不能集成。通过持续集成， 团队可以快速的从一个功能到另一">
<meta name="keywords" content="linux">
<meta property="og:type" content="article">
<meta property="og:title" content="jenkins">
<meta property="og:url" content="https://yellowbp.github.io/2021/07/31/jenkins/index.html">
<meta property="og:site_name" content="bp的Blog">
<meta property="og:description" content="jenkins持续集成持续集成（Continuous integration ， 简称 CI）指的是，频繁地（一天多次）将代码集成到主干(远程仓库)。 集成：集成的是团队的代码，而不是某个开发者的代码 持续集成的目的，就是让产品可以快速迭代，同时还能保持高质量。它的核心措施是，代码集成到主干之前，必须通过自动化测试。只要有一个测试用例失败，就不能集成。通过持续集成， 团队可以快速的从一个功能到另一">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E9%9B%86%E6%88%90%E6%B5%81%E7%A8%8B.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/web%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%BC%80%E5%90%AF%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%85%A8%E5%B1%80%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E9%A1%B9%E7%9B%AE%E8%A7%92%E8%89%B2.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E7%94%A8%E6%88%B7%E5%88%97%E8%A1%A8.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%85%A8%E5%B1%80%E8%A7%92%E8%89%B2%E5%88%86%E9%85%8D%E8%A7%92%E8%89%B2.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E9%A1%B9%E7%9B%AE%E8%A7%92%E8%89%B2%E5%88%86%E9%85%8D.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/jdk.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/maven.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/tomcat%E6%9E%84%E5%BB%BA.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E6%8B%89%E5%8F%96%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E8%A7%A6%E5%8F%91%E8%BF%9C%E7%A8%8B%E6%9E%84%E5%BB%BA.png">
<meta property="og:image" content="c:/Users/hbbbbbbbbp/AppData/Roaming/Typora/typora-user-images/image-20210727153930393.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/webhook%E5%85%A5%E5%8F%A31.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/gitlab%E5%8F%96%E6%B6%88%E5%8B%BE%E9%80%89.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%88%86%E6%94%AF%E5%8F%82%E6%95%B0.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/jenkins-loation.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/Extended-E-mail-Notifiation.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/Extended-E-mail-Notifiation02.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E9%82%AE%E4%BB%B6%E9%80%9A%E7%9F%A5.png">
<meta property="og:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E6%94%B6%E5%88%B0%E7%9A%84%E9%82%AE%E4%BB%B6%E8%AE%B0%E5%BD%95.jpg">
<meta property="og:updated_time" content="2022-03-10T12:33:46.475Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="jenkins">
<meta name="twitter:description" content="jenkins持续集成持续集成（Continuous integration ， 简称 CI）指的是，频繁地（一天多次）将代码集成到主干(远程仓库)。 集成：集成的是团队的代码，而不是某个开发者的代码 持续集成的目的，就是让产品可以快速迭代，同时还能保持高质量。它的核心措施是，代码集成到主干之前，必须通过自动化测试。只要有一个测试用例失败，就不能集成。通过持续集成， 团队可以快速的从一个功能到另一">
<meta name="twitter:image" content="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E9%9B%86%E6%88%90%E6%B5%81%E7%A8%8B.png">

  <meta name="format-detection" content="telephone=no,email=no">
  <meta name="theme-color" content="#9C27B0">
  <meta name="description" content>
  <meta name="keywords" content=",linux">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="bp的Blog">
  <meta name="msapplication-starturl" content="https://yellowbp.github.io/2021/07/31/jenkins/">
  <meta name="msapplication-navbutton-color" content="#9C27B0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="bp的Blog">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/images/favicon.png">

  
    <meta property="article:published_time" content="Sat Jul 31 2021 19:51:29 GMT+0800">
    <meta property="article:modified_time" content="Thu Mar 10 2022 20:33:46 GMT+0800">
  

  
    <link rel="canonical" href="https://yellowbp.github.io/2021/07/31/jenkins/">
  

  <meta name="google-site-verification" content="fXjtlIfaDc_X-0P11rO3bEp1Nk4IKXphoJv0GqGZCco">
  <meta name="baidu-site-verification" content="I3t1wfwZvd">

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create','UA-139531378-1','auto');ga('send','pageview');
</script>
  <script>
  var _hmt = _hmt || [];
  (function() {var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?1054d51c0b66f1d168829173682c8159';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script>
  

  <link rel="stylesheet" href="/css/mdui.css">
<link rel="stylesheet" href="/css/style.css">
</head>
<body class="mdui-appbar-with-toolbar mdui-drawer-body-left mdui-theme-primary-brown mdui-theme-accent-blue">
  <script>var a=localStorage.getItem("mdui-theme-layout-dark");if(a){document.getElementsByTagName("body")[0].className+=" mdui-theme-layout-dark"};</script>
  <header id="header" class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide mdui-appbar-inset">
  <div class="mdui-toolbar mdui-color-theme">
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="mdui-icon material-icons">menu</i></a>
    <a href="/" class="mdui-typo-headline">bp的Blog</a>
    <div class="mdui-toolbar-spacer"></div>
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: '搜索'}"><i class="mdui-icon material-icons">search</i></a>
    
  </div>
</header>
<div class="mdui-dialog" id="search">
  
    <div class="search-form">
      <input type="search" class="search-form-input" placeholder="请输入关键字">
    </div>
    <div class="search-result" data-resource="/search.xml"></div>
  
</div>
  <aside id="sidebar" class="mdui-drawer mdui-drawer-full-height">
  <div class="mdui-grid-tile">
    <img src="/images/Gradient1.jpg" style="height: 160px;">
    <img src="/images/headPic.jpg" class="avatar-animation" style="position: absolute; top: 10%; left: 24px; width: 64px; height: 64px; border: 2px solid #fff; border-radius: 50%;">
    <div class="mdui-grid-tile-actions">
      <div class="mdui-grid-tile-text">
        <div class="mdui-grid-tile-title">hbp
        </div>
        <div class="mdui-grid-tile-subtitle"><i class="mdui-icon material-icons">art_track</i>要想快，先会慢</div>
      </div>
      
        <div class="mdui-grid-tile-buttons">
          <a href="mailto:347070556@qq.com" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: '347070556@qq.com'}"><i class="mdui-icon material-icons">email</i></a>
        </div>
      
    </div>
  </div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    <a href="/" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">home</i>
      <div class="mdui-list-item-content">主页</div>
    </a>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-deep-orange">inbox</i>
        <div class="mdui-list-item-content">归档</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/archives/2022/03/">三月 2022<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2022/02/">二月 2022<span class="mdui-ripple sidebar_archives-count">13</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/10/">十月 2021<span class="mdui-ripple sidebar_archives-count">9</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/09/">九月 2021<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/08/">八月 2021<span class="mdui-ripple sidebar_archives-count">5</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/07/">七月 2021<span class="mdui-ripple sidebar_archives-count">11</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/06/">六月 2021<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/05/">五月 2021<span class="mdui-ripple sidebar_archives-count">5</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/04/">四月 2021<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/03/">三月 2021<span class="mdui-ripple sidebar_archives-count">10</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/02/">二月 2021<span class="mdui-ripple sidebar_archives-count">4</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2021/01/">一月 2021<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2020/03/">三月 2020<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/12/">十二月 2019<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/11/">十一月 2019<span class="mdui-ripple sidebar_archives-count">5</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/10/">十月 2019<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2019/08/">八月 2019<span class="mdui-ripple sidebar_archives-count">6</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-green">chrome_reader_mode</i>
        <div class="mdui-list-item-content">分类</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/categories/ElasticSearch/">ElasticSearch<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/Spring/">Spring<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/SpringBoot/">SpringBoot<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/SpringCloud-Alibaba/">SpringCloud Alibaba<span class="mdui-ripple sidebar_archives-count">7</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/SpringMVC/">SpringMVC<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/docker/">docker<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/excel/">excel<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/git/">git<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/java8/">java8<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/java基础/">java基础<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/jenkins/">jenkins<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/jenkins/docker/">docker<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/jwt/">jwt<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/k8s/">k8s<span class="mdui-ripple sidebar_archives-count">10</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/linux/">linux<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/linux搭建/">linux搭建<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/maven/">maven<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/mybatis/">mybatis<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/mysql/">mysql<span class="mdui-ripple sidebar_archives-count">4</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/nginx/">nginx<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/redis/">redis<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/servlet/">servlet<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/spring/">spring<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/ssm/">ssm<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/yaml/">yaml<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/上传下载文件/">上传下载文件<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/乱码/">乱码<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/参数校验/">参数校验<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/发短信/">发短信<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/小程序/">小程序<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/工具类/">工具类<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/开发软件/">开发软件<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/技术/">技术<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/搭建博客/">搭建博客<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/电脑硬件/">电脑硬件<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/算法/">算法<span class="mdui-ripple sidebar_archives-count">7</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/缓存/">缓存<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/虚拟机/">虚拟机<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/规范/">规范<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/认证授权/">认证授权<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/设计模式/">设计模式<span class="mdui-ripple sidebar_archives-count">4</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/部署/">部署<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/重装/">重装<span class="mdui-ripple sidebar_archives-count">1</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-brown">bookmark</i>
        <div class="mdui-list-item-content">标签</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/tags/Spring/">Spring<span class="mdui-ripple sidebar_archives-count">22</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/algorithm/">algorithm<span class="mdui-ripple sidebar_archives-count">7</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/excel/">excel<span class="mdui-ripple sidebar_archives-count">5</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/git/">git<span class="mdui-ripple sidebar_archives-count">13</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/hexo/">hexo<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/javaWeb/">javaWeb<span class="mdui-ripple sidebar_archives-count">7</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/java基础/">java基础<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/jwt/">jwt<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/linux/">linux<span class="mdui-ripple sidebar_archives-count">5</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/mysql/">mysql<span class="mdui-ripple sidebar_archives-count">6</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/nginx/">nginx<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/redis/">redis<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/servlet/">servlet<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/spring/">spring<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/win7/">win7<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/其他/">其他<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/分布式/">分布式<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/接口文档/">接口文档<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/笔记本选购/">笔记本选购<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/自动化构建工具/">自动化构建工具<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/设计模式/">设计模式<span class="mdui-ripple sidebar_archives-count">4</span></a>
        
      </div>
    </div>
    <a href="/about" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-purple">person</i>
      <div class="mdui-list-item-content">关于</div>
    </a>
  </div>

  <div class="mdui-divider"></div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <div class="mdui-list-item-content">友情链接</div>
        <i class="mdui-list-item-icon mdui-icon material-icons">link</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        
          <a href="javascript:;" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme" style="justify-content: center;">链接为空</a>
        
      </div>
    </div>
  </div>
</aside>
  <main id="main" class="mdui-m-t-5 fadeIn animated">
  <link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css">
  <style>#main article .mdui-card-content .center-block{display:block!important;margin-right:auto!important;margin-left:auto!important}</style>
  <article class="mdui-card mdui-m-b-5">
    <header class="mdui-card-media">
      <img src="/images/random/material-9.png" style="max-height: 240px;">
      <div class="mdui-card-media-covered">
        <div class="mdui-card-primary">
          <div class="mdui-card-primary-title">jenkins</div>
          <div class="mdui-card-primary-subtitle"><i class="iconfont">&#xe697;</i> 2021-07-31 / 
          <i class="iconfont">&#xe601;</i> hbp
          <span id="busuanzi_container_page_pv">
            本文总阅读量<span id="busuanzi_value_page_pv"></span>次
          </span>
          </div>
        </div>
      </div>
      <div class="mdui-card-menu">
        
        
      </div>
    </header>
    <div class="mdui-card-content mdui-typo">
      <h1 id="jenkins"><a href="#jenkins" class="headerlink" title="jenkins"></a>jenkins</h1><h2 id="持续集成"><a href="#持续集成" class="headerlink" title="持续集成"></a>持续集成</h2><p>持续集成（Continuous integration ， 简称 CI）指的是，频繁地（一天多次）将代码集成到主干(远程仓库)。</p>
<p>集成：集成的是团队的代码，而不是某个开发者的代码</p>
<p>持续集成的目的，就是让产品可以快速迭代，同时还能保持高质量。它的核心措施是，代码集成到主干之前，必须通过自动化测试。只要有一个测试用例失败，就不能集成。<br>通过持续集成， 团队可以快速的从一个功能到另一个功能，简而言之，敏捷软件开发很大一部分都要归功于持续集成</p>
<h3 id="持续集成流程"><a href="#持续集成流程" class="headerlink" title="持续集成流程"></a><strong>持续集成流程</strong></h3><ul>
<li>提交<br>流程的第一步，是开发者向代码仓库提交代码。所有后面的步骤都始于本地代码的一次提交（commit）。</li>
<li>测试（第一轮）<br>代码仓库对commit操作配置了钩子（hook），只要提交代码或者合并进主干，就会跑自动化测试。</li>
<li>构建<br>通过第一轮测试，代码就可以合并进主干，就算可以交付了。<br>交付后，就先进行构建（build），再进入第二轮测试。所谓构建，指的是将源码转换为可以运行的实际代码，比如安装依赖，配置各种资源（样式表、JS脚本、图片）等等。</li>
<li>测试（第二轮）<br>构建完成，就要进行第二轮测试。如果第一轮已经涵盖了所有测试内容，第二轮可以省略，当然，这时构建步骤也要移到第一轮测试前面。</li>
<li>部署<br>过了第二轮测试，当前代码就是一个可以直接部署的版本（artifact）。将这个版本的所有文件打包（tar filename.tar *）存档，发到生产服务器。</li>
<li>回滚<br>一旦当前版本发生问题，就要回滚到上一个版本的构建结果。最简单的做法就是修改一下符号链接，指向上一个版本的目录。</li>
</ul>
<h3 id="持续集成的组成要素"><a href="#持续集成的组成要素" class="headerlink" title="持续集成的组成要素"></a>持续集成的组成要素</h3><ul>
<li>一个<strong>自动化</strong>构建过程， 这个过程需要大量的软件来支撑。从检出代码、 编译构建、 运行测试、 结果记录、 测试统计等都是自动完成的， 无需人工干预。</li>
<li>一个代码存储库，即需要版本控制软件来保障代码的可维护性，同时作为构建过程的素材库，一般使用SVN或Git。</li>
<li>一个持续集成服务器， Jenkins 就是一个配置简单和使用方便的持续集成服务器。</li>
</ul>
<p>以上要素缺一不可</p>
<h3 id="持续集成的好处"><a href="#持续集成的好处" class="headerlink" title="持续集成的好处"></a>持续集成的好处</h3><ol>
<li>降低风险，由于持续集成不断去构建，编译和测试，可以很早期发现问题，所以修复的代价就少；</li>
<li>对系统健康持续检查，减少发布风险带来的问题；</li>
<li>减少重复性工作；（不用说像之前那样，开发好了之后，自行合并分支，然后打包部署）</li>
<li>持续部署，提供可部署单元包；</li>
<li>持续交付可供使用的版本；</li>
</ol>
<h2 id="jenkins介绍安装"><a href="#jenkins介绍安装" class="headerlink" title="jenkins介绍安装"></a>jenkins介绍安装</h2><p>像上面持续集成组成要素所知：要有一个持续集成服务器。</p>
<p>Jenkins 是一款开源持续集成工具。能够搭建持续集成服务器，具有自动化构建、测试和部署等功能的工具。</p>
<p>jenkins 有丰富的插件支持，其实 jenkins 就是通过安装大量插件来完成自动化构建等功能</p>
<h3 id="持续集成流程-1"><a href="#持续集成流程-1" class="headerlink" title="持续集成流程"></a>持续集成流程</h3><img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E9%9B%86%E6%88%90%E6%B5%81%E7%A8%8B.png" style="zoom:80%;">

<ol>
<li>首先，开发人员每天进行代码提交，提交到Git仓库</li>
<li>然后，Jenkins作为持续集成工具，使用 Git 工具到 Git 仓库拉取代码到集成服务器，再配合 JDK，Maven 等软件完成代码编译，代码测试与审查，测试，打包等工作，在这个过程中每一步出错，都重新再执行一次整个流程。</li>
<li>最后，Jenkins把生成的 jar 或 war 包分发到测试服务器或者生产服务器，测试人员或用户就可以访问应用。</li>
</ol>
<p>服务器列表</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>ip地址</th>
<th>安装的软件</th>
</tr>
</thead>
<tbody><tr>
<td>代码托管服务器</td>
<td>xxx</td>
<td>gitlab</td>
</tr>
<tr>
<td>持续集成服务器</td>
<td>xxx</td>
<td>jenkins、jdk、maven、git、sonarQube</td>
</tr>
<tr>
<td>应用测试服务器</td>
<td>xxx</td>
<td>jdk、tomcat</td>
</tr>
</tbody></table>
<h3 id="Gitlab代码托管服务器安装"><a href="#Gitlab代码托管服务器安装" class="headerlink" title="Gitlab代码托管服务器安装"></a>Gitlab代码托管服务器安装</h3><p>Gitlab用户在组里面有5种不同权限：</p>
<ul>
<li>Guest：可以创建issue、发表评论，不能读写版本库 </li>
<li>Reporter：可以克隆代码，不能提交，QA、PM可以赋予这个权限 </li>
<li>Developer：可以克隆代码、开发、提交、push，普通开发可以赋予这个权限</li>
<li>Maintainer：可以创建项目、添加tag、保护分支、添加项目成员、编辑项目，核心开发可以赋予这个权限 </li>
<li>Owner：可以设置项目访问权限 - Visibility Level、删除项目、迁移项目、管理组成员，开发组组长可以赋予这个权限</li>
</ul>
<h3 id="项目上传到gitlab仓库"><a href="#项目上传到gitlab仓库" class="headerlink" title="项目上传到gitlab仓库"></a>项目上传到gitlab仓库</h3><p>首先用Idea准备一个简单的web项目，把此项目上传到代码托管服务器</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/web%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png" alt="web项目结构" style="zoom:80%;">

<ol>
<li><p>Idea开启版本控制，选择Git管理</p>
<p><img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%BC%80%E5%90%AF%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6.png" alt="开启版本控制"></p>
</li>
<li><p>关联远程仓库</p>
<p>VCS –&gt; Git –&gt; remotes</p>
<p>输入远程仓库的账号密码</p>
</li>
<li><p>提交推送代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add.</span><br><span class="line">git commit -m <span class="string">'jenkins项目初始化'</span> .</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="持续集成环境搭建与配置"><a href="#持续集成环境搭建与配置" class="headerlink" title="持续集成环境搭建与配置"></a>持续集成环境搭建与配置</h2><h3 id="Jenkins安装"><a href="#Jenkins安装" class="headerlink" title="Jenkins安装"></a>Jenkins安装</h3><ol>
<li><p>安装jdk，因为jdk是用 java 开发的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install java-1.8.0-openjdk* -y</span><br></pre></td></tr></table></figure>

<p>默认安装的目录为：/usr/lib/jvm</p>
</li>
<li><p>获取jenkins安装包<br>下载页面：<a href="https://jenkins.io/zh/download/" target="_blank" rel="noopener">https://jenkins.io/zh/download/</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo</span><br><span class="line">sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key</span><br><span class="line">yum install jenkins</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 jenkins 配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/jenkins</span><br></pre></td></tr></table></figure>

<p>修改内容如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认是 jenkins，代表使用jenkins的用户，这时候就需要为本机创建jenkins用户</span></span><br><span class="line">JENKINS_USER=<span class="string">"root"</span></span><br><span class="line"><span class="comment"># 默认是8080，为了避免端口冲突</span></span><br><span class="line">JENKINS_PORT=<span class="string">"8888"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在防火墙添加端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 永久添加8888端口</span></span><br><span class="line">firewall--cmd --zone=public --add-port=8888/tcp --permanent</span><br><span class="line"><span class="comment"># 重启防火墙</span></span><br><span class="line">firewall--cmd --reload</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动 jenkins 服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start jenkins</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问地址：ip:8888</p>
</li>
<li><p>初次访问，需要解锁jenkins，按照提示，找到密码并输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/lib/jenkins/secrets/initialAdminPassword</span><br></pre></td></tr></table></figure>
</li>
<li><p>跳过插件安装</p>
<p>因为jenkins插件需要连接默认官网下载，速度非常慢，所以我们暂时跳过插件安装，后续配置国内的镜像，会快很多</p>
<p>选择插件来安装 –&gt; “无”</p>
</li>
</ol>
<h3 id="Jenkins插件管理"><a href="#Jenkins插件管理" class="headerlink" title="Jenkins插件管理"></a>Jenkins插件管理</h3><p>Jenkins本身不提供很多功能，我们可以通过使用插件来满足我们的使用。例如从Gitlab拉取代码，使用Maven构建项目等功能需要依靠插件完成。</p>
<p>总的来书：jenkins 是插件的集合体</p>
<h4 id="修改Jenkins插件下载地址"><a href="#修改Jenkins插件下载地址" class="headerlink" title="修改Jenkins插件下载地址"></a><strong>修改</strong>Jenkins插件下载地址</h4><p>Jenkins国外官方插件地址下载速度非常慢，所以可以修改为国内插件地址：</p>
<ol>
<li><p>Jenkins-&gt;Manage Jenkins-&gt;Manage Plugins，点击Available</p>
<p>目的：为了把Jenkins官方的插件列表下载到本地，接着修改地址文件，替换为国内插件地址</p>
</li>
<li><p>进入jenkins默认的开发目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/lib/jenkins</span><br></pre></td></tr></table></figure>
</li>
<li><p>里面有个 updates 目录，updates里有个文件叫 default.json ，里面记录着刚才官网网站所有插件的地址，不过这些地址都是国外的，下载速度慢</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /updates</span><br></pre></td></tr></table></figure>
</li>
<li><p>换下载源，其实就是把官网地址换一下，谷歌地址换一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">'s/http:\/\/updates.jenkinsci.org\/download/https:\/\/mirrors.tuna.tsinghua.edu.cn\/jenkins/g'</span> default.json &amp;&amp; sed -i <span class="string">'s/http:\/\/www.google.com/https:\/\/www.baidu.com/g'</span> default.json</span><br></pre></td></tr></table></figure>
</li>
<li><p>最后，Manage Plugins点击Advanced，把Update Site改为国内插件下载地址后，submit</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启 jenkins ： ip:port/restart </p>
</li>
</ol>
<h4 id="下载中文汉化插件"><a href="#下载中文汉化插件" class="headerlink" title="下载中文汉化插件"></a>下载中文汉化插件</h4><p>Jenkins-&gt;Manage Jenkins-&gt;Manage Plugins，点击Available，搜索”Chinese” –&gt; 勾选 “Localization: Chinese (Simplified)” –&gt; 下载并重启(重启后才能生效)</p>
<p>重启Jenkins后，就看到Jenkins汉化了！（PS：但可能部分菜单汉化会失败）</p>
<h3 id="Jenkins用户权限管理"><a href="#Jenkins用户权限管理" class="headerlink" title="Jenkins用户权限管理"></a>Jenkins用户权限管理</h3><p>jenkins默认是粗粒度的权限管理。</p>
<p>平时日常开发中，会有很多用户登录jenkins，得需要对不同的用户授予不用的角色与权限</p>
<p>以利用Role-based Authorization Strategy 插件来管理Jenkins 细粒度的用户权限管理</p>
<ol>
<li><p>安装Role-based Authorization Strategy插件，直接安装即可，不需要重启</p>
</li>
<li><p>开启权限全局安全配置：Manage Jenkins –&gt; security大模块 –&gt;  Configure Global Security</p>
<p>授权策略切换为”Role-Based Strategy”，默认是 登录用户可以做任何事情，由此也可以看出来jenkins是粗粒度权限管理</p>
</li>
<li><p>利用策略为jenkins创建角色</p>
<ol>
<li><p>Manage Jenkins –&gt; Manage and Assign Roles –&gt;  “Manage Roles”</p>
</li>
<li><p>可以看到界面有 三大角色</p>
<ul>
<li><p>Global roles（全局角色），全局角色一般是分配用户能得到 jenkins 哪些基本的功能默认情况。全局角色就有一个admin角色，第一次安装jenkins新建的用户就属于admin角色</p>
</li>
<li><p>Item roles（项目角色），针对某个或者某些项目能被哪些的用户所访问。</p>
</li>
<li><p>Node roles（节点角色），用户jenkins主从机制所使用的角色(这里暂时不用到)</p>
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h4 id="用户角色权限示例"><a href="#用户角色权限示例" class="headerlink" title="用户角色权限示例"></a>用户角色权限示例</h4><h5 id="创建角色"><a href="#创建角色" class="headerlink" title="创建角色"></a>创建角色</h5><p>这里添加以下三个角色：</p>
<p>全局角色：baseRole，这个角色需要绑定 Overall 下面的 Read 权限，是为了给所有用户绑定最基本的 Jenkins 访问权限。注意：如果不给后续用户绑定这个角色，会报错误：用户名 ismissing the Overall/Read permission</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%85%A8%E5%B1%80%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90.png" alt="全局角色权限" style="zoom:67%;">

<p>项目角色2个：</p>
<p>Pattern一般是写正则表达式，写一般可以访问的项目名</p>
<ol>
<li><p>role01：使用正则表达式绑定”employee.*”，意思是只能操作employee开头的项目。</p>
</li>
<li><p>role02：绑定”straff.*”，意思是只能操作straff开头的项目。</p>
</li>
</ol>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E9%A1%B9%E7%9B%AE%E8%A7%92%E8%89%B2.png" alt="项目角色" style="zoom: 67%;">

<h5 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h5><ol>
<li><p>Manage Jenkins –&gt;  Manage Users –&gt; 新建用户</p>
</li>
<li><p>创建了2个用户用来测试（如果此时没有为这两个用户分配角色的话，如果用这两个用户登录进去，会提示没有Read访问权限）</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E7%94%A8%E6%88%B7%E5%88%97%E8%A1%A8.png" alt="用户列表" style="zoom: 70%;">

</li>
</ol>
<h5 id="分配角色"><a href="#分配角色" class="headerlink" title="分配角色"></a>分配角色</h5><p>Manage Jenkins –&gt; Manage and Assign Roles –&gt; Assign Roles</p>
<p>绑定规则如下：</p>
<ul>
<li><p>bpRole01用户分别绑定全局角色baseRole和项目角色role01角色</p>
</li>
<li><p>bpRole02用户分别绑定全局角色baseRole和项目角色role02角色</p>
</li>
</ul>
<p>如果只绑定了 baseRole 角色，则用户只能访问jenkins的一些界面而已</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%85%A8%E5%B1%80%E8%A7%92%E8%89%B2%E5%88%86%E9%85%8D%E8%A7%92%E8%89%B2.png" alt="全局角色分配角色" style="zoom: 78%;">

<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E9%A1%B9%E7%9B%AE%E8%A7%92%E8%89%B2%E5%88%86%E9%85%8D.png" alt="项目角色分配" style="zoom:70%;">

<h5 id="创建项目测试权限"><a href="#创建项目测试权限" class="headerlink" title="创建项目测试权限"></a><strong>创建项目测试权限</strong></h5><p>以管理员账户创建两个测试项目，分别为employeeProject和straffProject</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95%E9%A1%B9%E7%9B%AE.png" alt="创建测试项目" style="zoom:80%;">

<p>测试结果为：</p>
<p>bpRole01用户登录，只能看到employee项目</p>
<p>bpRole02用户登录，只能看到straff项目</p>
<h3 id="Jenkins凭证管理"><a href="#Jenkins凭证管理" class="headerlink" title="Jenkins凭证管理"></a>Jenkins凭证管理</h3><p>凭据可以用来存储需要密文保护的数据库密码、Gitlab密码信息、Docker私有仓库密码等，以便Jenkins可以和这些第三方的应用进行交互。jenkins本身是不支持凭证管理的(本身是通过硬编码的方式)，需要借助插件</p>
<h4 id="安装Credentials-Binding插件"><a href="#安装Credentials-Binding插件" class="headerlink" title="安装Credentials Binding插件"></a>安装Credentials Binding插件</h4><p>在插件管理中，直接搜索”Credentials Binding”，然后直接安装</p>
<p>安装完毕之后，出现在 Manage Jenkins –&gt; Manage Credentials 中（旧版本的jenkins是出现在首页的左侧导航栏），当然用户的个人中心也有。</p>
<p>可以添加的凭证有5种：</p>
<ul>
<li><p>Username with password：用户名和密码</p>
</li>
<li><p>SSH Username with private key： 使用SSH密钥进行免密登录</p>
</li>
<li><p>Secret fifile：需要保密的文本文件，使用时Jenkins会将文件复制到一个临时目录中，再将文件路径设置到一个变量中，等构建结束后，所复制的Secret fifile就会被删除。</p>
</li>
<li><p>Secret text：需要保存的一个加密的文本串，如钉钉机器人或Github的api token</p>
</li>
<li><p>Certifificate：通过上传证书文件的方式</p>
</li>
</ul>
<p>常用的凭证类型有：Username with password（用户密码）和SSH Username with private key（SSH密钥）</p>
<p>接下来以使用Git工具到Gitlab拉取项目源码为例，演示Jenkins的如何管理Gitlab的凭证。</p>
<h4 id="Jenkins通过git插件从远程仓库拉取项目源码"><a href="#Jenkins通过git插件从远程仓库拉取项目源码" class="headerlink" title="Jenkins通过git插件从远程仓库拉取项目源码"></a>Jenkins通过git插件从远程仓库拉取项目源码</h4><h5 id="安装Git插件和Git工具"><a href="#安装Git插件和Git工具" class="headerlink" title="安装Git插件和Git工具"></a><strong>安装</strong>Git插件和Git工具</h5><p>为了让Jenkins支持从远程仓库拉取源码，需要在<strong>jenkins中安装Git插件</strong>以及在<strong>CentOS7上安装Git工具</strong>。</p>
<ul>
<li><p>jenkins中，直接在插件管理中 搜索安装Git插件即可</p>
</li>
<li><p>在centos7中安装Git工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装git</span></span><br><span class="line">yum install git -y </span><br><span class="line"><span class="comment"># 查看git版本</span></span><br><span class="line">git --version</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h5 id="用户密码类型"><a href="#用户密码类型" class="headerlink" title="用户密码类型"></a><strong>用户密码类型</strong></h5><ol>
<li>创建凭证：Manage Jenkins –&gt; 凭证 –&gt; 添加凭证</li>
<li>选择 <code>username with password</code>，在用户名和密码处 ，输入拉取代码时的用户名和密码</li>
</ol>
<h6 id="测试凭证是否可用"><a href="#测试凭证是否可用" class="headerlink" title="测试凭证是否可用"></a>测试凭证是否可用</h6><ol>
<li><p>创建一个FreeStyle项目</p>
</li>
<li><p>找到”源码管理”-&gt;”Git”，在Repository URL复制Gitlab中的项目URL，这时会报错说无法连接仓库！在Credentials选择刚刚添加的凭证就不报错（jenkins在验证凭证的合法性）</p>
</li>
<li><p>保存配置后，点击左侧导航栏构建”Build Now“ 开始构建项目，点进去构建历史中，查看控制台输出记录，从中我们可以知道，jenkins通过git拉取，把项目放入了服务器的何处</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查看/var/lib/jenkins/workspace/目录，发现已经从gitee成功拉取了代码到Jenkins中。</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="SSH密钥免密登录"><a href="#SSH密钥免密登录" class="headerlink" title="SSH密钥免密登录"></a>SSH密钥免密登录</h5><p>SSH免密登录，需要把公钥存放在远程仓库中，把私钥存放在Jenkins服务器中</p>
<ol>
<li><p>使用root用户生成公钥和私钥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>

<p>一直回车即可，生成的公私钥存放在 <code>/root/.ssh/目录中</code></p>
</li>
<li><p>把生成的公钥放在gitee中（私钥要用管理员账号登录才能添加公钥证书） </p>
<p>以root账户登录 -&gt; 点击头像 -&gt; Settings-&gt;SSH Keys</p>
<p>复制刚才id_rsa.pub文件的内容到这里，点击”Add Key</p>
</li>
<li><p>在Jenkins中添加凭证，配置私钥</p>
<p>在Jenkins添加一个新的凭证，类型为”SSH Username with private key”，把刚才生成私有文件内容复制过来</p>
</li>
<li><p>自行拉取项目测试</p>
</li>
</ol>
<h3 id="Maven安装和配置"><a href="#Maven安装和配置" class="headerlink" title="Maven安装和配置"></a>Maven安装和配置</h3><p>在Jenkins集成服务器上，我们需要安装Maven来把拉取下来的项目源码进行 编译和打包项目。</p>
<h4 id="安装Maven"><a href="#安装Maven" class="headerlink" title="安装Maven"></a><strong>安装</strong>Maven</h4><ol>
<li><p>把maven压缩包上传到 linux 服务器后</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压</span></span><br><span class="line">tar -xzf apache-maven-3.6.2-bin.tar.gz </span><br><span class="line"><span class="comment"># 创建目录</span></span><br><span class="line">mkdir -p /opt/maven </span><br><span class="line"><span class="comment"># 移动文件</span></span><br><span class="line">mv apache-maven-3.6.2/* /opt/maven</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置环境变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br><span class="line"><span class="comment"># 末尾追加下面的代码</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk</span><br><span class="line"><span class="built_in">export</span> MAVEN_HOME=/opt/maven </span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$MAVEN_HOME</span>/bin</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置生效</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profifile</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看maven版本来验证是否安装成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -v</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="Jenkins关联JDK和maven"><a href="#Jenkins关联JDK和maven" class="headerlink" title="Jenkins关联JDK和maven"></a>Jenkins关联JDK和maven</h4><p>Jenkins –&gt; Global Tool Confifiguration</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/jdk.png" alt="jdk" style="zoom:67%;">

<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/maven.png" alt="maven" style="zoom:67%;">

<h5 id="添加Jenkins全局变量"><a href="#添加Jenkins全局变量" class="headerlink" title="添加Jenkins全局变量"></a><strong>添加</strong>Jenkins全局变量</h5><p>这步骤相当于在linux配置全局变量，目的是让jenkins感知maven的命令</p>
<p>Manage Jenkins-&gt;Confifigure System-&gt; Global Properties –&gt; 环境变量 ，添加三个全局变量</p>
<table>
<thead>
<tr>
<th>key</th>
<th>value</th>
</tr>
</thead>
<tbody><tr>
<td>JAVA_HOME</td>
<td>/usr/lib/jvm/java-1.8.0-openjdk</td>
</tr>
<tr>
<td>M2_HOME</td>
<td>/opt/maven</td>
</tr>
<tr>
<td>PATH+EXTRA</td>
<td>$M2_HOME/bin</td>
</tr>
</tbody></table>
<h5 id="修改Maven的settings-xml"><a href="#修改Maven的settings-xml" class="headerlink" title="修改Maven的settings.xml"></a><strong>修改</strong>Maven的settings.xml</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建本地仓库目录</span></span><br><span class="line">mkdir /root/repo </span><br><span class="line">vim /opt/maven/conf/settings.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--本地仓库修改为/root/repo--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>/root/repo<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--添加阿里云私服地址--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span>   </span><br><span class="line"> <span class="tag">&lt;<span class="name">mirrorof</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorof</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="测试Maven是否配置成功"><a href="#测试Maven是否配置成功" class="headerlink" title="测试Maven是否配置成功"></a>测试Maven是否配置成功</h5><p>使用之前的gitee密码测试项目，修改配置，只需要增加点步骤：构建-&gt;增加构建步骤-&gt;Execute Shell</p>
<p>输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package</span><br></pre></td></tr></table></figure>

<h3 id="Tomcat安装和配置"><a href="#Tomcat安装和配置" class="headerlink" title="Tomcat安装和配置"></a>Tomcat安装和配置</h3><h4 id="安装Tomcat8-5"><a href="#安装Tomcat8-5" class="headerlink" title="安装Tomcat8.5"></a>安装Tomcat8.5</h4><ol>
<li><p>确保jdk已经安装成功（yum install java-1.8.0-openjdk* -y）</p>
</li>
<li><p>把Tomcat压缩包上传到虚拟机服务器</p>
</li>
<li><p>解压</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-tomcat-8.5.47.tar.gz</span><br></pre></td></tr></table></figure>
</li>
<li><p>移动文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /opt/tomcat 创建目录mv /root/apache-tomcat-8.5.47/* /opt/tomcat 移动文件</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动tomcat</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入tomcat目录</span></span><br><span class="line"><span class="built_in">cd</span>/opt/tomcat/bin</span><br><span class="line"><span class="comment"># 启动tomcat</span></span><br><span class="line">./startup.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>开启防火墙端口，或则关闭防火墙</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看所有开启的端口</span></span><br><span class="line">firewall-cmd --list-ports</span><br><span class="line"><span class="comment"># 开启8080端口</span></span><br><span class="line">firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br><span class="line"><span class="comment"># 重启防火墙(更新防火墙规则)：</span></span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="配置Tomcat用户角色权限"><a href="#配置Tomcat用户角色权限" class="headerlink" title="配置Tomcat用户角色权限"></a><strong>配置</strong>Tomcat用户角色权限</h4><p>默认情况下Tomcat是没有配置用户角色权限的，入口在 tomcat猫首页的Managing Tomcat –&gt; manager webapp</p>
<p>但是，后续Jenkins部署项目到Tomcat服务器，需要用到Tomcat的用户，所以修改tomcat以下配置，添加用户及权限</p>
<ol>
<li><p>添加用户及权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vim /opt/tomcat/conf/tomcat-users.xml</span><br><span class="line"><span class="comment"># 添加的内容如下</span></span><br><span class="line">&lt;tomcat-users&gt; </span><br><span class="line">	&lt;role rolename=<span class="string">"tomcat"</span>/&gt; </span><br><span class="line">	&lt;role rolename=<span class="string">"role1"</span>/&gt; </span><br><span class="line">	&lt;role rolename=<span class="string">"manager-script"</span>/&gt; </span><br><span class="line">	&lt;role rolename=<span class="string">"manager-gui"</span>/&gt; </span><br><span class="line">	&lt;role rolename=<span class="string">"manager-status"</span>/&gt; </span><br><span class="line">	&lt;role rolename=<span class="string">"admin-gui"</span>/&gt; </span><br><span class="line">	&lt;role rolename=<span class="string">"admin-script"</span>/&gt; </span><br><span class="line">	&lt;user username=<span class="string">"tomcat"</span> password=<span class="string">"tomcat"</span> roles=<span class="string">"manager-gui,manager- script,tomcat,admin-gui,admin-script"</span>/&gt; </span><br><span class="line">&lt;/tomcat-users&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>开启远程访问的功能</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /opt/tomcat/webapps/manager/META-INF/context.xml</span><br><span class="line"># 注释下面的代码</span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">&lt;Valve className="org.apache.catalina.valves.RemoteAddrValve" allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1" /&gt; --&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>重启Tomcat，访问测试</p>
<blockquote>
<p>/opt/tomcat/bin/shutdown.sh<br>/opt/tomcat/bin/startup.sh </p>
</blockquote>
</li>
</ol>
<h2 id="Jenkins项目构建类型"><a href="#Jenkins项目构建类型" class="headerlink" title="Jenkins项目构建类型"></a>Jenkins项目构建类型</h2><p>Jenkins中自动构建项目的类型有很多，常用的有以下三种：</p>
<ul>
<li>自由风格软件项目（FreeStyle Project）</li>
<li>Maven项目（Maven Project）</li>
<li><strong>流水线项目（Pipeline Project）</strong></li>
</ul>
<p>每种类型的构建其实都可以完成一样的构建过程与结果，只是在操作方式、灵活度等方面有所区别，在实际开发中可以根据自己的需求和习惯来选择。（PS：个人推荐使用流水线类型，因为灵活度非常高）</p>
<h3 id="自由风格项目构建"><a href="#自由风格项目构建" class="headerlink" title="自由风格项目构建"></a>自由风格项目构建</h3><p>下面演示创建一个自由风格项目来完成项目的集成过程：</p>
<blockquote>
<p>拉取代码 -&gt; 编译 -&gt; 打包 -&gt; 部署</p>
</blockquote>
<h4 id="拉取代码"><a href="#拉取代码" class="headerlink" title="拉取代码"></a>拉取代码</h4><ol>
<li>在 Jenkins 中新建任务，类型为 默认的自由风格类型</li>
<li>配置源码管理，从gitee拉取项目源码</li>
</ol>
<h4 id="编译打包"><a href="#编译打包" class="headerlink" title="编译打包"></a><strong>编译打包</strong></h4><p>构建 –&gt; 添加构建步骤 –&gt; Executor Shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"开始编译和打包"</span> </span><br><span class="line">mvn clean package </span><br><span class="line"><span class="built_in">echo</span> <span class="string">"编译和打包结束"</span></span><br></pre></td></tr></table></figure>

<p>编译打包完之后，我们可以看到 target目录下生成了一个项目的 war 包</p>
<h4 id="部署"><a href="#部署" class="headerlink" title="部署"></a><strong>部署</strong></h4><p>把项目部署到远程的Tomcat里面</p>
<ol>
<li><p>安装 Deploy to container插件</p>
<p>Jenkins本身无法实现远程部署到Tomcat的功能，需要安装Deploy to container插件实现</p>
</li>
<li><p>添加Tomcat用户凭证</p>
</li>
<li><p>添加构建后操作</p>
<p>在任务配置中，找到 构建后的操作 –&gt;  Deploy war/ear to a container</p>
<p>WAR/EAR files： 找到war包，填写的是 war包的位置，可以填个比较通用的</p>
<p>tomcat凭证这一块，用户名密码是tomcat配置中添加的(上述安装tomcat时已经添加)</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/tomcat%E6%9E%84%E5%BB%BA.png" alt="tomcat构建" style="zoom:80%;">
</li>
<li><p>点击”Build Now”，开始构建过程</p>
</li>
<li><p>部署成功后，访问项目：<a href="http://ip:8080/web_demo-1.0-SNAPSHOT/" target="_blank" rel="noopener">http://ip:8080/web_demo-1.0-SNAPSHOT/</a></p>
</li>
</ol>
<h3 id="Maven项目构建"><a href="#Maven项目构建" class="headerlink" title="Maven项目构建"></a>Maven项目构建</h3><ol>
<li><p>安装Maven Integration插件</p>
</li>
<li><p>在Jenkins中创建Maven类型的项目</p>
</li>
<li><p>配置项目，拉取代码和远程部署的过程和自由风格项目一样，只是”构建”部分不同</p>
<p>Goals and options 中输入的时maven的命名（不用输入mvn前缀），只需要 clean package 即可</p>
</li>
</ol>
<h3 id="Pipeline流水线项目构建"><a href="#Pipeline流水线项目构建" class="headerlink" title="Pipeline流水线项目构建(*)"></a>Pipeline流水线项目构建(*)</h3><h4 id="Pipeline简介"><a href="#Pipeline简介" class="headerlink" title="Pipeline简介"></a><strong>Pipeline</strong>简介</h4><p>1）概念</p>
<p>Pipeline，简单来说，就是一套运行在 Jenkins 上的工作流框架，将原来独立运行于单个或者多个节点的任务连接起来，实现单个任务难以完成的复杂流程编排和可视化的工作。</p>
<p>2）使用Pipeline有以下好处（来自翻译自官方文档）：</p>
<p>代码：Pipeline以代码的形式实现，通常被检入源代码控制，使团队能够编辑，审查和迭代其传送流程。 持久：无论是计划内的还是计划外的服务器重启，Pipeline都是可恢复的。 可停止：Pipeline可接收交互式输入，以确定是否继续执行Pipeline。 多功能：Pipeline支持现实世界中复杂的持续交付要求。它支持fork/join、循环执行，并行执行任务的功能。 可扩展：Pipeline插件支持其DSL的自定义扩展 ，以及与其他插件集成的多个选项。</p>
<p><strong>区别：</strong></p>
<p>自由风格和maven类型的项目，他们每个阶段，每个工作时分开的，即拉取代码构建构建后的操作时分开的，而Pipeline把这些分散的节点统一管理</p>
<h4 id="如何创建-Jenkins-Pipeline"><a href="#如何创建-Jenkins-Pipeline" class="headerlink" title="如何创建 Jenkins Pipeline"></a>如何创建 Jenkins Pipeline</h4><ul>
<li>Pipeline 脚本是由 <strong>Groovy</strong> 语言实现的，但是我们没必要单独去学习 Groovy</li>
<li>Pipeline 支持两种语法：<strong><em>Declarative</em></strong>(声明式)和 <strong>Scripted Pipeline</strong>(脚本式)语法</li>
<li>Pipeline 也有两种创建方法：可以直接在 Jenkins 的 Web UI 界面中输入脚本；也可以通过创建一个 Jenkinsfile 脚本文件放入项目源码库中，即放在项目目录中（推荐）</li>
</ul>
<h4 id="安装Pipeline插件"><a href="#安装Pipeline插件" class="headerlink" title="安装Pipeline插件"></a>安装Pipeline插件</h4><p>Manage Jenkins –&gt; Manage Plugins –&gt; 可选插件 –&gt; Pipeline</p>
<p>安装插件后，创建项目的时候多了“流水线”类型</p>
<h4 id="Pipeline语法快速入门"><a href="#Pipeline语法快速入门" class="headerlink" title="Pipeline语法快速入门"></a><strong>Pipeline</strong>语法快速入门</h4><h5 id="Declarative声明式-常用"><a href="#Declarative声明式-常用" class="headerlink" title="Declarative声明式(常用)"></a>Declarative声明式(常用)</h5><ol>
<li><p>创建Pipeline类型项目</p>
</li>
<li><p>流水线 –&gt; 选择HelloWorld模板</p>
<p>流水线项目已经没有其他类型项目中的 拉取代码、构建、构建后的操作 的模块了，都集中在流水线中</p>
<p>生成内容如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line"></span><br><span class="line">   <span class="comment">// stages：代表整个流水线的所有执行阶段。通常stages只有1个，里面包含多个stage</span></span><br><span class="line">    stages &#123;</span><br><span class="line">        <span class="comment">// stage：代表流水线中的某个阶段，可能出现n个。一般分为拉取代码，编译构建，部署等阶段。</span></span><br><span class="line">        stage(<span class="string">'Hello'</span>) &#123;</span><br><span class="line">            <span class="comment">// steps：代表一个阶段内需要执行的逻辑。steps里面是shell脚本，git拉取代码，ssh远程发布等任意内容。</span></span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">'Hello World'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写一个简单声明式Pipeline：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line"></span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">'拉取代码'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">'拉取代码'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'编译构建'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">'编译构建'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'项目部署'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">'项目部署'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>点击构建，可以看到整个构建过程，并且会有构建时各个阶段所需时间</p>
</li>
</ol>
<h5 id="Scripted-Pipeline脚本式"><a href="#Scripted-Pipeline脚本式" class="headerlink" title="Scripted Pipeline脚本式"></a>Scripted Pipeline脚本式</h5><ol>
<li><p>创建项目，跟上面一样</p>
</li>
<li><p>这次选择”Scripted Pipeline” </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">node &#123;</span><br><span class="line">    def mvnHome</span><br><span class="line">    stage(<span class="string">'拉取代码'</span>) &#123; </span><br><span class="line">        echo <span class="string">'拉取代码'</span></span><br><span class="line">    &#125;</span><br><span class="line">    stage(<span class="string">'编译构建'</span>) &#123;</span><br><span class="line">        echo <span class="string">'编译构建'</span></span><br><span class="line">    &#125;</span><br><span class="line">    stage(<span class="string">'部署'</span>) &#123;</span><br><span class="line">        echo <span class="string">'部署'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Node：节点，一个 Node 就是一个 Jenkins 节点，Master 或者 Agent，是执行 Step 的具体运行环境，后续讲到Jenkins的Master-Slave架构的时候用到。</li>
<li>Stage：阶段，一个 Pipeline 可以划分为若干个 Stage，每个 Stage 代表一组操作，比如：Build、Test、Deploy，Stage 是一个逻辑分组的概念。</li>
<li>Step：步骤，Step 是最基本的操作单元，可以是打印一句话，也可以是构建一个 Docker 镜像，由各类 Jenkins 插件提供，比如命令：sh ‘make’，就相当于我们平时 shell 终端中执行 make 命令一样</li>
<li>其实跟声明式相差无几</li>
</ul>
</li>
<li><p>构建结果和声明式一样！</p>
</li>
</ol>
<p><strong>pipeline的语法可以不用会写，有个pipeline脚本生成器帮我们生成</strong></p>
<h4 id="拉取代码-1"><a href="#拉取代码-1" class="headerlink" title="拉取代码"></a>拉取代码</h4><ol>
<li><p>点击流水线 –&gt; 流水线语法</p>
</li>
<li><p>片段生成器 –&gt; checkout 拉取代码，选择好url、凭证、分支后，点击生成脚本</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E6%8B%89%E5%8F%96%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8.png" alt="拉取代码生成器" style="zoom:50%;">
</li>
<li><p>把脚本复制到流水线的拉取代码阶段</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">'拉取代码'</span>) &#123;</span><br><span class="line">            <span class="comment">// steps：代表一个阶段内需要执行的逻辑。steps里面是shell脚本，git拉取代码，ssh远程发布等任意内容。</span></span><br><span class="line">            steps &#123;</span><br><span class="line">                checkout([$class: 'GitSCM', branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[credentialsId: '4b37c091-a1e4-461e-b027-f1855f7f6445', url: 'git@gitee.com:hbbbbbbbbp/web-demo.git']]])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试拉取</p>
</li>
</ol>
<h4 id="编译打包-1"><a href="#编译打包-1" class="headerlink" title="编译打包"></a>编译打包</h4><p>流水线语法 –&gt; 片段生成器 –&gt; 下拉选择 “sh: Shell Script” –&gt; 输入 “mvn clean package” –&gt; 生成的脚本粘贴到流水线中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line"></span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">'拉取代码'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                checkout([$class: 'GitSCM', branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[credentialsId: '4b37c091-a1e4-461e-b027-f1855f7f6445', url: 'git@gitee.com:hbbbbbbbbp/web-demo.git']]])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;    </span><br><span class="line">        stage(<span class="string">'编译打包'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh <span class="string">'mvn clean package'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>项目的target目录下 生成了 war 包</p>
<h4 id="部署-1"><a href="#部署-1" class="headerlink" title="部署"></a>部署</h4><p>片段选择器 –&gt;  Deploy  ，下面填写的选项与上述tomcat部署是一样的，唯一不同的是 前者可以选择多个tomcat进行部署</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line"></span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">'拉取代码'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                checkout([$class: 'GitSCM', branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[credentialsId: '4b37c091-a1e4-461e-b027-f1855f7f6445', url: 'git@gitee.com:hbbbbbbbbp/web-demo.git']]])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;    </span><br><span class="line">        stage(<span class="string">'编译打包'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh <span class="string">'mvn clean package'</span></span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'部署'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                deploy adapters: [tomcat8(credentialsId: <span class="string">'cbb162c3-5570-4dc0-a785-f7c76f69b855'</span>, <span class="attr">path</span>: <span class="string">''</span>, <span class="attr">url</span>: <span class="string">'http://192.168.37.1:8080'</span>)], <span class="attr">contextPath</span>: <span class="literal">null</span>, <span class="attr">war</span>: <span class="string">'target/*.war'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Pipeline-Script-from-SCM"><a href="#Pipeline-Script-from-SCM" class="headerlink" title="Pipeline Script from SCM"></a><strong>Pipeline Script from SCM</strong></h4><p>上面我们都是直接在 Jenkins 的UI界面编写Pipeline代码，这样不方便脚本维护，建议把Pipeline脚本放在项目中（一起进行版本控制）</p>
<ol>
<li><p>在项目根目录建立Jenkinsfifile文件，把内容复制到该文件中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">'拉取代码'</span>) &#123;</span><br><span class="line">            </span><br><span class="line">            steps &#123;</span><br><span class="line">                checkout([$class: 'GitSCM', branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[credentialsId: '4b37c091-a1e4-461e-b027-f1855f7f6445', url: 'git@gitee.com:hbbbbbbbbp/web-demo.git']]])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;    </span><br><span class="line">        stage(<span class="string">'编译打包'</span>) &#123;</span><br><span class="line"></span><br><span class="line">            steps &#123;</span><br><span class="line">                sh <span class="string">'mvn clean package'</span></span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'部署'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                deploy adapters: [tomcat8(credentialsId: <span class="string">'cbb162c3-5570-4dc0-a785-f7c76f69b855'</span>, <span class="attr">path</span>: <span class="string">''</span>, <span class="attr">url</span>: <span class="string">'http://192.168.11.11:8080'</span>)], <span class="attr">contextPath</span>: <span class="literal">null</span>, <span class="attr">war</span>: <span class="string">'target/*.war'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>把Jenkinsfile上传到远程仓库</p>
</li>
<li><p>jenkins流水线选择 “Pipeline Script for SCM”，选择脚本名名称，其他配置即可</p>
</li>
</ol>
<h2 id="Jenkins常用的构建触发器"><a href="#Jenkins常用的构建触发器" class="headerlink" title="Jenkins常用的构建触发器"></a>Jenkins常用的构建触发器</h2><p>之前都是我们自己手动构建，那么Jenkins提供了可以自动构建化功能</p>
<p>Jenkins内置（不需要安装插件）4种构建触发器：</p>
<ol>
<li>触发远程构建</li>
<li>其他工程构建后触发（Build after other projects are build）</li>
<li>定时构建（Build periodically）</li>
<li>轮询SCM（Poll SCM）</li>
</ol>
<h3 id="触发远程构建"><a href="#触发远程构建" class="headerlink" title="触发远程构建"></a><strong>触发远程构建</strong></h3><img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E8%A7%A6%E5%8F%91%E8%BF%9C%E7%A8%8B%E6%9E%84%E5%BB%BA.png" alt="触发远程构建" style="zoom:67%;">

<p>令牌一般会进行加密处理</p>
<p>触发的url：<a href="http://192.168.11.61:8888/job/web_demo_pipeline/build?token=6666" target="_blank" rel="noopener">http://192.168.11.61:8888/job/web_demo_pipeline/build?token=6666</a></p>
<h3 id="其他工程构建后触发"><a href="#其他工程构建后触发" class="headerlink" title="其他工程构建后触发"></a><strong>其他工程构建后触发</strong></h3><p>这个方式的自动化构建是 依赖于另外一个项目的构建来触发完成的</p>
<ol>
<li>创建前置工程：pre_job流水线工程</li>
<li>配置需要触发的工程：pre_job，当pre_job完成构建后可以自动触发下一个工程的构建</li>
</ol>
<h3 id="定时构建"><a href="#定时构建" class="headerlink" title="定时构建"></a><strong>定时构建</strong></h3><p>定时字符串从左往右分别为： 分 时 日 月 周</p>
<p>如：当你输入“* * * * *” 时，意思为“每分钟”，H * * * * 意思是每小时</p>
<p>一些定时表达式的例子：</p>
<blockquote>
<p>每30分钟构建一次：H代表形参 ：H/30 * * * * 10:02 10:32</p>
<p>每2个小时构建一次: H H/2 * * *</p>
<p>每天的8点，12点，22点，一天构建3次： (多个时间点中间用逗号隔开) 0 8,12,22 * * *</p>
<p>每天中午12点定时构建一次 H 12 * * *</p>
<p>每天下午18点定时构建一次 H 18 * * *</p>
<p>在每个小时的前半个小时内的每10分钟 H(0-29)/10 * * * *</p>
<p>每两小时一次，每个工作日上午9点到下午5点(也许是上午10:38，下午12:38，下午2:38，下午</p>
<p>4:38) H H(9-16)/2 * * 1-5</p>
</blockquote>
<h3 id="轮询SCM"><a href="#轮询SCM" class="headerlink" title="轮询SCM"></a><strong>轮询</strong>SCM</h3><p>轮询SCM，是指定时扫描本地代码仓库的代码是否有变更，如果代码有变更就触发项目构建。</p>
<p>注意：这次构建触发器，Jenkins会定时扫描本地整个项目的代码，增大系统的开销，不建议使用</p>
<h2 id="Jenkins-Git-hook自动触发构建"><a href="#Jenkins-Git-hook自动触发构建" class="headerlink" title="Jenkins-Git hook自动触发构建(*)"></a><strong>Jenkins</strong>-Git hook自动触发构建(*)</h2><p>刚才我们看到在Jenkins的内置构建触发器中，轮询SCM可以实现Gitlab代码更新，项目自动构建，但是该方案的性能不佳。那有没有更好的方案呢？ 有的。就是利用Gitlab的webhook实现代码push到仓库，立即触发项目自动构建。</p>
<p>webhook原理：</p>
<p>远程仓库代码变更 –&gt; 发送构建请求–&gt;  Jenkins</p>
<h3 id="安装Gitlab-Hook插件"><a href="#安装Gitlab-Hook插件" class="headerlink" title="安装Gitlab Hook插件"></a><strong>安装</strong>Gitlab Hook插件</h3><p>需要安装2个插件（注意：插件是随着远程仓库的变化而变化，如果远程仓库是gitee的话，只需要安装 Gitee Plugin即可）：</p>
<ul>
<li><p>Gitlab Hook</p>
</li>
<li><p>GitLab</p>
</li>
</ul>
<h3 id="Jenkins设置自动构建"><a href="#Jenkins设置自动构建" class="headerlink" title="Jenkins设置自动构建"></a><strong>Jenkins</strong>设置自动构建</h3><p>安装了插件之后，我们便可以在构建触发器中看到多出了个选项：</p>
<img src="C:\Users\hbbbbbbbbp\AppData\Roaming\Typora\typora-user-images\image-20210727153930393.png" alt="image-20210727153930393" style="zoom:67%;">

<p>复制url，把此url粘贴到gitee中</p>
<h3 id="Gitlab配置webhook"><a href="#Gitlab配置webhook" class="headerlink" title="Gitlab配置webhook"></a><strong>Gitlab</strong>配置webhook</h3><ol>
<li><p>添加webhook</p>
<p><img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/webhook%E5%85%A5%E5%8F%A31.png" alt="webhook入口1" style="zoom:67%;">把gitee的url粘贴在此</p>
</li>
<li><p>如果是gitlab以下设置必须完成，否则会报错！</p>
<p>Manage Jenkins –&gt; Confifigure System</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/gitlab%E5%8F%96%E6%B6%88%E5%8B%BE%E9%80%89.png" alt="gitlab取消勾选" style="zoom:67%;">
</li>
<li><p>自行测试提交代码，看是否有自动构建</p>
</li>
</ol>
<h2 id="Jenkins的参数化构建"><a href="#Jenkins的参数化构建" class="headerlink" title="Jenkins的参数化构建"></a>Jenkins的参数化构建</h2><p>有时在项目构建的过程中，我们需要根据用户的输入动态传入一些参数，从而影响整个构建结果，比如，一开始我们在项目中创建了一个名叫 “Jenkinsfile” 的脚本文件，jenkins可以读取里面的脚本，从而进行构建项目，但是如果每次都需要手动在项目里面改变比如分支这个参数的话，硬编码方式就会变得更加麻烦，这时我们可以使用参数化构建。</p>
<p>Jenkins支持非常丰富的参数类型</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B.png" alt="参数化构建过程" style="zoom:80%;">

<p>接下来演示通过输入gitlab项目的分支名称来部署不同分支项目。</p>
<ol>
<li><p>项目创建分支，并推送到Gitlab上</p>
</li>
<li><p>新建分支：dev，代码稍微改动下，然后提交到gitlab上。这时看到gitlab上有一个两个分支：master和dev</p>
</li>
<li><p>在Jenkins添加字符串类型参数，保存后，构建按钮已经发生改变</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E5%88%86%E6%94%AF%E5%8F%82%E6%95%B0.png" alt="分支参数" style="zoom:80%;">
</li>
<li><p>改动项目中 jenkinsfile 流水线代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 拉取代码的这一块 ，master 改为下面的参数表达式</span><br><span class="line">branches: [[name: <span class="string">'*/$&#123;branch&#125;'</span>]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>点击Build with Parameters。输入分支名称，构建即可！构建完成后访问Tomcat查看结果</p>
</li>
</ol>
<h2 id="Jenkins配置邮箱服务器发送构建结果"><a href="#Jenkins配置邮箱服务器发送构建结果" class="headerlink" title="Jenkins配置邮箱服务器发送构建结果"></a>Jenkins配置邮箱服务器发送构建结果</h2><h3 id="安装Email-Extension-Template插件-djetmrbqhcrxbhhf"><a href="#安装Email-Extension-Template插件-djetmrbqhcrxbhhf" class="headerlink" title="安装Email Extension Template插件  djetmrbqhcrxbhhf"></a>安装Email Extension Template插件  djetmrbqhcrxbhhf</h3><h3 id="Jenkins设置邮箱相关参数"><a href="#Jenkins设置邮箱相关参数" class="headerlink" title="Jenkins设置邮箱相关参数"></a><strong>Jenkins</strong>设置邮箱相关参数</h3><ol>
<li><p>Manage Jenkins-&gt;Confifigure System</p>
</li>
<li><p>设置邮件参数</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/jenkins-loation.png" alt="jenkins loation" style="zoom:67%;">
</li>
<li><p>邮箱开启 SMTP 服务，并记住密码</p>
<ol>
<li><img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/Extended-E-mail-Notifiation.png" alt="Extended E-mail Notifiation" style="zoom: 67%;">

<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/Extended-E-mail-Notifiation02.png" alt="Extended E-mail Notifiation02" style="zoom:67%;">

</li>
</ol>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E9%82%AE%E4%BB%B6%E9%80%9A%E7%9F%A5.png" alt="邮件通知" style="zoom:67%;">



</li>
</ol>
<ol start="4">
<li><p>准备邮件内容</p>
<p>在项目根目录编写email.html，并把文件推送到Gitlab，内容如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>$&#123;ENV, var="JOB_NAME"&#125;-第$&#123;BUILD_NUMBER&#125;次构建日志<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">leftmargin</span>=<span class="string">"8"</span> <span class="attr">marginwidth</span>=<span class="string">"0"</span> <span class="attr">topmargin</span>=<span class="string">"8"</span> <span class="attr">marginheight</span>=<span class="string">"4"</span> <span class="attr">offset</span>=<span class="string">"0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">"95%"</span> <span class="attr">cellpadding</span>=<span class="string">"0"</span> <span class="attr">cellspacing</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">style</span>=<span class="string">"font-size: 11pt; font-family: Tahoma, Arial, Helvetica, sans- serif"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>(本邮件是程序自动下发的，请勿回复！)<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">h2</span>&gt;</span><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#0000FF"</span>&gt;</span>构建结果 - $&#123;BUILD_STATUS&#125;<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;/<span class="name">h2</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span> <span class="tag">&lt;<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#0B610B"</span>&gt;</span>构建信息<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> <span class="attr">size</span>=<span class="string">"2"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">align</span>=<span class="string">"center"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>项目名称<span class="symbol">&amp;nbsp;</span>：<span class="symbol">&amp;nbsp;</span>$&#123;PROJECT_NAME&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>构建编号<span class="symbol">&amp;nbsp;</span>：<span class="symbol">&amp;nbsp;</span>第$&#123;BUILD_NUMBER&#125;次构建<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>触发原因：<span class="symbol">&amp;nbsp;</span>$&#123;CAUSE&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>构建日志：<span class="symbol">&amp;nbsp;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;BUILD_URL&#125;console"</span>&gt;</span>$&#123;BUILD_URL&#125;console<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>构建<span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>Url<span class="symbol">&amp;nbsp;</span>：<span class="symbol">&amp;nbsp;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;BUILD_URL&#125;"</span>&gt;</span>$&#123;BUILD_URL&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>工作目录<span class="symbol">&amp;nbsp;</span>：<span class="symbol">&amp;nbsp;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;PROJECT_URL&#125;ws"</span>&gt;</span>$&#123;PROJECT_URL&#125;ws<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>项目<span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>Url<span class="symbol">&amp;nbsp;</span>：<span class="symbol">&amp;nbsp;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;PROJECT_URL&#125;"</span>&gt;</span>$&#123;PROJECT_URL&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#0B610B"</span>&gt;</span>Changes Since Last Successful Build:<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> <span class="attr">size</span>=<span class="string">"2"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">align</span>=<span class="string">"center"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    编写Jenkinsfile添加构建后发送邮件</span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>历史变更记录 : <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;PROJECT_URL&#125;changes"</span>&gt;</span>$&#123;PROJECT_URL&#125;changes<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            $&#123;CHANGES_SINCE_LAST_SUCCESS,reverse=true, format="Changes for Build #%n:<span class="tag">&lt;<span class="name">br</span>/&gt;</span>%c<span class="tag">&lt;<span class="name">br</span>/&gt;</span>",showPaths=true,changesFormat="</span><br><span class="line">            <span class="tag">&lt;<span class="name">pre</span>&gt;</span>[%a]<span class="tag">&lt;<span class="name">br</span>/&gt;</span>%m<span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line">            ",pathFormat="<span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>%p"&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Failed Test Results<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> <span class="attr">size</span>=<span class="string">"2"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">align</span>=<span class="string">"center"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pre</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">style</span>=<span class="string">"font-size: 11pt; font-family: Tahoma, Arial, Helvetica, sans-serif"</span>&gt;</span>$FAILED_TESTS</span><br><span class="line">            <span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">br</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#0B610B"</span>&gt;</span>构建日志 (最后 100行):<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span> <span class="attr">size</span>=<span class="string">"2"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">align</span>=<span class="string">"center"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">cols</span>=<span class="string">"80"</span> <span class="attr">rows</span>=<span class="string">"30"</span> <span class="attr">readonly</span>=<span class="string">"readonly"</span> <span class="attr">style</span>=<span class="string">"font-family: Courier New"</span>&gt;</span>$&#123;BUILD_LOG, maxLines=100&#125;<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写Jenkinsfifile添加构建后发送邮件</p>
<p>流水线语法 –&gt;  Declarative Directive Generator  生成出post后 –&gt;  片段生成器 选择emailext</p>
<p>【注意】post是跟stages同级的，post里面可以有类似if -else 判断，就如果stages成功，就怎么怎么样，否则怎么怎么样</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">'拉取代码'</span>) &#123;  </span><br><span class="line">            steps &#123;</span><br><span class="line">                checkout([$class: 'GitSCM', branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[credentialsId: '4b37c091-a1e4-461e-b027-f1855f7f6445', url: 'git@gitee.com:hbbbbbbbbp/web-demo.git']]])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;    </span><br><span class="line">        stage(<span class="string">'编译打包'</span>) &#123;</span><br><span class="line"></span><br><span class="line">            steps &#123;</span><br><span class="line">                sh <span class="string">'mvn clean package'</span></span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'部署'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                deploy adapters: [tomcat8(credentialsId: <span class="string">'cbb162c3-5570-4dc0-a785-f7c76f69b855'</span>, <span class="attr">path</span>: <span class="string">''</span>, <span class="attr">url</span>: <span class="string">'http://192.168.11.11:8080'</span>)], <span class="attr">contextPath</span>: <span class="literal">null</span>, <span class="attr">war</span>: <span class="string">'target/*.war'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        post &#123; </span><br><span class="line">            always &#123; </span><br><span class="line">                emailext( subject: <span class="string">'构建通知：$&#123;PROJECT_NAME&#125; - Build # $&#123;BUILD_NUMBER&#125; - $&#123;BUILD_STATUS&#125;!'</span>, </span><br><span class="line">                body: <span class="string">'$&#123;FILE,path="email.html"&#125;'</span>, </span><br><span class="line">                to: <span class="string">'xxx@qq.com'</span> ) </span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
<img src="https://jenkinsimage.oss-cn-guangzhou.aliyuncs.com/jenkinsimages/%E6%94%B6%E5%88%B0%E7%9A%84%E9%82%AE%E4%BB%B6%E8%AE%B0%E5%BD%95.jpg" alt="收到的邮件记录" style="zoom:67%;">

<p>【注意】：上面html中的变量是邮件的全局参数：</p>
<p>邮件相关全局参数参考列表：</p>
<p>系统设置-&gt;Extended E-mail Notifification-&gt;Content Token Reference，点击旁边的?号</p>
</li>
</ol>

      <blockquote class="mdui-m-t-5">
        
          <strong>本文遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC BY-NC-SA 4.0</a> 许可协议，转载请附上原文出处链接和本声明。</strong><br>
        
        <strong>本文链接：</strong><a href="https://yellowbp.github.io/2021/07/31/jenkins/">https://yellowbp.github.io/2021/07/31/jenkins/</a>
      </blockquote>
      
    </div>
    <footer class="mdui-card-actions">
      
        <a class="mdui-ripple article_categories-link" href="/categories/jenkins/">jenkins</a>
      
      
        <a class="mdui-ripple article_tags-link" href="/tags/linux/">linux</a>
      
    </footer>
    
  </article>
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script>$("#main article .mdui-card-content img.fancybox").on("click",function(e){$.fancybox.open({src:$(this).attr("src")});});</script>


  <nav id="paginator">
    
      <a rel="prev" class="extend prev" href="/2021/08/21/ElasticSearch--基本操作/">
        <button aria-label="prev" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_back</i></button>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;上一篇
      </a>
    
    <div class="spacer"></div>
    
      <a rel="next" class="extend next" href="/2021/07/29/docker/">
        下一篇&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <button aria-label="next" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_forward</i></button>
      </a>
    
  </nav>


  <div id="comment" class="mdui-m-t-5">
    <style>#pop_ad,#feedAv{display:none!important;position:absolute!important;z-index:-9999;left:-1000px;opacity:0!important}</style>
<div id="SOHUCS" sid="cl0saizp2008l9ktw6kvby6wo"></div>
<script type="text/javascript">
(function(){
var appid = 'cyubhC2Dq';
var conf = 'prod_e4cce65003c5bed049fefcb8a6f09e12';
var width = window.innerWidth || document.documentElement.clientWidth;
if (width < 960) {
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("http://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>
  </div>



  <div style="position: fixed !important; right: 16px; top: 30%;">
    <button class="mdui-fab mdui-fab-mini mdui-ripple" mdui-menu="{target: '#toc'}"><i class="mdui-icon material-icons">format_list_numbered</i></button>
    <ul class="mdui-menu" id="toc">
      <li class="mdui-menu-item" disabled><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#jenkins"><span class="toc-number">1.</span> <span class="toc-text">jenkins</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#持续集成"><span class="toc-number">1.1.</span> <span class="toc-text">持续集成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#持续集成流程"><span class="toc-number">1.1.1.</span> <span class="toc-text">持续集成流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#持续集成的组成要素"><span class="toc-number">1.1.2.</span> <span class="toc-text">持续集成的组成要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#持续集成的好处"><span class="toc-number">1.1.3.</span> <span class="toc-text">持续集成的好处</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jenkins介绍安装"><span class="toc-number">1.2.</span> <span class="toc-text">jenkins介绍安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#持续集成流程-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">持续集成流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gitlab代码托管服务器安装"><span class="toc-number">1.2.2.</span> <span class="toc-text">Gitlab代码托管服务器安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#项目上传到gitlab仓库"><span class="toc-number">1.2.3.</span> <span class="toc-text">项目上传到gitlab仓库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#持续集成环境搭建与配置"><span class="toc-number">1.3.</span> <span class="toc-text">持续集成环境搭建与配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins安装"><span class="toc-number">1.3.1.</span> <span class="toc-text">Jenkins安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins插件管理"><span class="toc-number">1.3.2.</span> <span class="toc-text">Jenkins插件管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#修改Jenkins插件下载地址"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">修改Jenkins插件下载地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#下载中文汉化插件"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">下载中文汉化插件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins用户权限管理"><span class="toc-number">1.3.3.</span> <span class="toc-text">Jenkins用户权限管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#用户角色权限示例"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">用户角色权限示例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#创建角色"><span class="toc-number">1.3.3.1.1.</span> <span class="toc-text">创建角色</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#创建用户"><span class="toc-number">1.3.3.1.2.</span> <span class="toc-text">创建用户</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#分配角色"><span class="toc-number">1.3.3.1.3.</span> <span class="toc-text">分配角色</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#创建项目测试权限"><span class="toc-number">1.3.3.1.4.</span> <span class="toc-text">创建项目测试权限</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins凭证管理"><span class="toc-number">1.3.4.</span> <span class="toc-text">Jenkins凭证管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装Credentials-Binding插件"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">安装Credentials Binding插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Jenkins通过git插件从远程仓库拉取项目源码"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">Jenkins通过git插件从远程仓库拉取项目源码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#安装Git插件和Git工具"><span class="toc-number">1.3.4.2.1.</span> <span class="toc-text">安装Git插件和Git工具</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#用户密码类型"><span class="toc-number">1.3.4.2.2.</span> <span class="toc-text">用户密码类型</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#测试凭证是否可用"><span class="toc-number">1.3.4.2.2.1.</span> <span class="toc-text">测试凭证是否可用</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SSH密钥免密登录"><span class="toc-number">1.3.4.2.3.</span> <span class="toc-text">SSH密钥免密登录</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Maven安装和配置"><span class="toc-number">1.3.5.</span> <span class="toc-text">Maven安装和配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装Maven"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">安装Maven</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Jenkins关联JDK和maven"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">Jenkins关联JDK和maven</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#添加Jenkins全局变量"><span class="toc-number">1.3.5.2.1.</span> <span class="toc-text">添加Jenkins全局变量</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#修改Maven的settings-xml"><span class="toc-number">1.3.5.2.2.</span> <span class="toc-text">修改Maven的settings.xml</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#测试Maven是否配置成功"><span class="toc-number">1.3.5.2.3.</span> <span class="toc-text">测试Maven是否配置成功</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tomcat安装和配置"><span class="toc-number">1.3.6.</span> <span class="toc-text">Tomcat安装和配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装Tomcat8-5"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">安装Tomcat8.5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#配置Tomcat用户角色权限"><span class="toc-number">1.3.6.2.</span> <span class="toc-text">配置Tomcat用户角色权限</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins项目构建类型"><span class="toc-number">1.4.</span> <span class="toc-text">Jenkins项目构建类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#自由风格项目构建"><span class="toc-number">1.4.1.</span> <span class="toc-text">自由风格项目构建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#拉取代码"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">拉取代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编译打包"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">编译打包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#部署"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">部署</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Maven项目构建"><span class="toc-number">1.4.2.</span> <span class="toc-text">Maven项目构建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pipeline流水线项目构建"><span class="toc-number">1.4.3.</span> <span class="toc-text">Pipeline流水线项目构建(*)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Pipeline简介"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">Pipeline简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#如何创建-Jenkins-Pipeline"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">如何创建 Jenkins Pipeline</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#安装Pipeline插件"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">安装Pipeline插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pipeline语法快速入门"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">Pipeline语法快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Declarative声明式-常用"><span class="toc-number">1.4.3.4.1.</span> <span class="toc-text">Declarative声明式(常用)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Scripted-Pipeline脚本式"><span class="toc-number">1.4.3.4.2.</span> <span class="toc-text">Scripted Pipeline脚本式</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#拉取代码-1"><span class="toc-number">1.4.3.5.</span> <span class="toc-text">拉取代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编译打包-1"><span class="toc-number">1.4.3.6.</span> <span class="toc-text">编译打包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#部署-1"><span class="toc-number">1.4.3.7.</span> <span class="toc-text">部署</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pipeline-Script-from-SCM"><span class="toc-number">1.4.3.8.</span> <span class="toc-text">Pipeline Script from SCM</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins常用的构建触发器"><span class="toc-number">1.5.</span> <span class="toc-text">Jenkins常用的构建触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#触发远程构建"><span class="toc-number">1.5.1.</span> <span class="toc-text">触发远程构建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他工程构建后触发"><span class="toc-number">1.5.2.</span> <span class="toc-text">其他工程构建后触发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#定时构建"><span class="toc-number">1.5.3.</span> <span class="toc-text">定时构建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#轮询SCM"><span class="toc-number">1.5.4.</span> <span class="toc-text">轮询SCM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins-Git-hook自动触发构建"><span class="toc-number">1.6.</span> <span class="toc-text">Jenkins-Git hook自动触发构建(*)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装Gitlab-Hook插件"><span class="toc-number">1.6.1.</span> <span class="toc-text">安装Gitlab Hook插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins设置自动构建"><span class="toc-number">1.6.2.</span> <span class="toc-text">Jenkins设置自动构建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gitlab配置webhook"><span class="toc-number">1.6.3.</span> <span class="toc-text">Gitlab配置webhook</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins的参数化构建"><span class="toc-number">1.7.</span> <span class="toc-text">Jenkins的参数化构建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins配置邮箱服务器发送构建结果"><span class="toc-number">1.8.</span> <span class="toc-text">Jenkins配置邮箱服务器发送构建结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装Email-Extension-Template插件-djetmrbqhcrxbhhf"><span class="toc-number">1.8.1.</span> <span class="toc-text">安装Email Extension Template插件  djetmrbqhcrxbhhf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins设置邮箱相关参数"><span class="toc-number">1.8.2.</span> <span class="toc-text">Jenkins设置邮箱相关参数</span></a></li></ol></li></ol></li></ol></li>
    </ul>
  </div>
</main>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<footer id="footer" class="mdui-m-t-5 mdui-p-y-3 mdui-color-theme">
  <div class="mdui-p-y-0 mdui-text-center">
    
    
    
    
    
    
    
      <a href="https://github.com/yellowbp" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe7ab;</i></a>
    
    
    
    
    
      <a href="tencent://message/?uin=1432440963&Menu=yes" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe651;</i></a>
    
    
  </div>
  <div class="mdui-p-y-1 mdui-text-center">
    Copyright &copy; 2019 - 2022 hbp<br>
    Powered by <a href="https://hexo.io/" target="_blank" class="mdui-text-color-theme-accent">Hexo</a>hbp All rights reserved.
    
    <br>
    <span id="busuanzi_container_site_uv">
    本网站总访问量<span id="busuanzi_value_site_uv"></span>次
    </span>
  </div>
</footer>
  <button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-theme-accent"><i class="mdui-icon material-icons">arrow_upward</i></button>
  <script async src="http://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <script src="/js/mdui.js"></script>
<script src="/js/script.js"></script>
</body>
</html>